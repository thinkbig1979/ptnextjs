
========================================
  PLAYWRIGHT GLOBAL SETUP
========================================
Base URL: http://localhost:3000

[Global Setup] Step 1: Checking server availability...
[Global Setup] Server is responding!

[Global Setup] Step 1.5: Performing comprehensive health check...
[Global Setup] Health check passed! Database and test endpoints ready.

[Global Setup] Step 2: Clearing rate limits...
[Global Setup] Warning: Failed to clear rate limits. Tests may be affected.

[Global Setup] Step 3: Seeding test vendors...
[Global Setup] All 9 test vendors already exist (OK)
[Global Setup] Test vendors seeded successfully!

[Global Setup] Step 3.5: Waiting for vendor transactions to settle...

[Global Setup] Step 4: Seeding test products for tier2+ vendors...
[Global Setup] Some product seeding errors: {
  'product_0_Professional Marine Navigation System': 'The following field is invalid: Vendor',
  'product_1_Yacht Communication Suite': 'The following field is invalid: Vendor',
  'product_2_Marine Entertainment System': 'The following field is invalid: Vendor',
  'product_3_Premium Yacht Control System': 'The following field is invalid: Vendor',
  'product_4_Luxury Interior Lighting Package': 'The following field is invalid: Vendor'
}
[Global Setup] Warning: Some test products may not have been seeded.

========================================
  GLOBAL SETUP COMPLETE
========================================


Running 25 tests using 3 workers

TEST: Verifying admin login page loads without 401...
TEST: Verifying admin dashboard is accessible...
TEST: CRITICAL - Verifying /api/vendors does not return 401...
[OK] CRITICAL FIX VERIFIED: /api/vendors returns 200 (NOT 401)
[OK] Admin dashboard accessible: HTTP 200
  ✓   3 [chromium] › tests/e2e/dual-auth-system.spec.ts:47:9 › Dual Authentication System - 401 Error Fix › Test Suite 2: API Route Separation (CRITICAL FIX) › CRITICAL - /api/vendors route is NOT returning 401 (974ms)
[OK] Admin login page loaded: HTTP 200
TEST: Verifying /api/portal/vendors routes exist...
[OK] /api/portal/vendors/profile exists: HTTP 401
  ✓   4 [chromium] › tests/e2e/dual-auth-system.spec.ts:59:9 › Dual Authentication System - 401 Error Fix › Test Suite 2: API Route Separation (CRITICAL FIX) › /api/portal/vendors routes exist and are separate (432ms)
  ✓   2 [chromium] › tests/e2e/dual-auth-system.spec.ts:21:9 › Dual Authentication System - 401 Error Fix › Test Suite 1: Admin Panel Accessibility › Admin login page loads without 401 errors (1.5s)
TEST: Verifying vendor portal is accessible...
  ✓   1 [chromium] › tests/e2e/dual-auth-system.spec.ts:33:9 › Dual Authentication System - 401 Error Fix › Test Suite 1: Admin Panel Accessibility › Admin panel dashboard is accessible (1.6s)

========== FINAL TEST SUMMARY ==========

[OK] Vendor login page accessible: HTTP 200
[Registration] Filling form for: vendor-1765985338769-u9tzdk@test.example.com
  ✓   5 [chromium] › tests/e2e/dual-auth-system.spec.ts:73:9 › Dual Authentication System - 401 Error Fix › Test Suite 3: Vendor Portal Isolation › Vendor login page is functional and separate (1.1s)
  ✓   8 [chromium] › tests/e2e/vendor-onboarding/02-admin-approval.spec.ts:12:7 › VENDOR-ADMIN-P1: Admin Approval Workflow › Test 2.1: Admin login and navigation to pending vendors (290ms)
[Registration] Form filled successfully
[seedVendors] Seeding 1 vendors...
RESULTS:
  [OK] Admin panel accessible
  [OK] Vendor portal accessible
  [OK] Routes separated
  [OK] No 401 errors on /api/vendors (CRITICAL FIX)

========================================

  ✓   6 [chromium] › tests/e2e/dual-auth-system.spec.ts:89:9 › Dual Authentication System - 401 Error Fix › Test Suite 4: Summary › FINAL - All authentication systems working independently (2.0s)
[seedVendors] Seeding 1 vendors...
[seedVendors] Successfully seeded 1 vendors
  ✓   9 [chromium] › tests/e2e/vendor-onboarding/02-admin-approval.spec.ts:21:7 › VENDOR-ADMIN-P1: Admin Approval Workflow › Test 2.2: Admin approves vendor using seed helper (1.6s)
[Registration] Starting registration for: vendor-1765985341634-9du1h5@test.example.com
  ✓   7 [chromium] › tests/e2e/vendor-onboarding/01-registration.spec.ts:15:7 › VENDOR-REG-P1: Registration Workflow › Test 1.1: Successful registration with all fields (3.1s)
[seedVendors] Successfully seeded 1 vendors
[Registration] Filling form for: vendor-1765985341634-9du1h5@test.example.com
[Registration] Form filled successfully
[Registration] Vendor registered with ID: 6154
  ✓  12 [chromium] › tests/e2e/vendor-onboarding/01-registration.spec.ts:41:7 › VENDOR-REG-P1: Registration Workflow › Test 1.2: Validation errors for missing required fields (1.8s)
  ✓  13 [chromium] › tests/e2e/vendor-onboarding/01-registration.spec.ts:48:7 › VENDOR-REG-P1: Registration Workflow › Test 1.3: Invalid email format validation (1.2s)
[Registration] Filling form for: vendor-1765985344975-hci5k@test.example.com
[Registration] Form filled successfully
  ✓  14 [chromium] › tests/e2e/vendor-onboarding/01-registration.spec.ts:61:7 › VENDOR-REG-P1: Registration Workflow › Test 1.4: Password mismatch validation (1.9s)
  ✓  15 [chromium] › tests/e2e/vendor-onboarding/01-registration.spec.ts:72:7 › VENDOR-REG-P1: Registration Workflow › Test 1.5: Weak password rejection (1.1s)
[Registration] Filling form for: vendor-1765985347946-rsqy5@test.example.com
[Registration] Form filled successfully
[Registration] Filling form for: vendor-1765985347946-rsqy5@test.example.com
[Registration] Form filled successfully
  ✓  16 [chromium] › tests/e2e/vendor-onboarding/01-registration.spec.ts:85:7 › VENDOR-REG-P1: Registration Workflow › Test 1.6: Duplicate email detection (1.2s)
[Registration] Filling form for: vendor-1765985349142-4873z@test.example.com
[Registration] Form filled successfully
  ✓  17 [chromium] › tests/e2e/vendor-onboarding/01-registration.spec.ts:121:7 › VENDOR-REG-P1: Registration Workflow › Test 1.7: Submit button disabled during submission (969ms)
  ✓  18 [chromium] › tests/e2e/vendor-onboarding/01-registration.spec.ts:140:7 › VENDOR-REG-P1: Registration Workflow › Test 1.8: Form validation prevents submission with empty fields (874ms)
  ✓  10 [chromium] › tests/e2e/vendor-onboarding/03-authentication.spec.ts:9:7 › VENDOR-AUTH-P1: Authentication Workflow › Test 3.1: Login with valid credentials (32.9s)
[seedVendors] Seeding 1 vendors...
[seedVendors] Successfully seeded 1 vendors
  ✓  11 [chromium] › tests/e2e/vendor-onboarding/02-admin-approval.spec.ts:35:7 › VENDOR-ADMIN-P1: Admin Approval Workflow › Test 2.3: Pending vendor cannot login (403 forbidden) (32.3s)
[seedVendors] Seeding 1 vendors...
[seedVendors] Successfully seeded 1 vendors
  ✓  20 [chromium] › tests/e2e/vendor-onboarding/03-authentication.spec.ts:54:7 › VENDOR-AUTH-P1: Authentication Workflow › Test 3.3: Logout functionality (1.6s)
[seedVendors] Seeding 1 vendors...
[seedVendors] Successfully seeded 1 vendors
  ✓  19 [chromium] › tests/e2e/vendor-onboarding/03-authentication.spec.ts:38:7 › VENDOR-AUTH-P1: Authentication Workflow › Test 3.2: Login with invalid credentials (30.6s)
  ✓  23 [chromium] › tests/e2e/vendor-onboarding/03-authentication.spec.ts:117:7 › VENDOR-AUTH-P1: Authentication Workflow › Test 3.5: Protected route access without authentication (1.3s)
[seedVendors] Seeding 1 vendors...
[seedVendors] Successfully seeded 1 vendors
  ✓  21 [chromium] › tests/e2e/vendor-onboarding/02-admin-approval.spec.ts:54:7 › VENDOR-ADMIN-P1: Admin Approval Workflow › Test 2.4: Approved vendor can login successfully (31.4s)
[seedVendors] Seeding 1 vendors...
[seedVendors] Successfully seeded 1 vendors
  ✓  25 [chromium] › tests/e2e/vendor-onboarding/02-admin-approval.spec.ts:83:7 › VENDOR-ADMIN-P1: Admin Approval Workflow › Test 2.5: Admin rejects vendor application using seed helper (175ms)
  ✓  22 [chromium] › tests/e2e/vendor-onboarding/03-authentication.spec.ts:84:7 › VENDOR-AUTH-P1: Authentication Workflow › Test 3.4: Session persistence across page reloads (31.8s)
  ✓  24 [chromium] › tests/e2e/vendor-onboarding/03-authentication.spec.ts:123:7 › VENDOR-AUTH-P1: Authentication Workflow › Test 3.6: Token refresh behavior (33.0s)

  25 passed (1.4m)
