{"id":"ptnextjs-0089","title":"health-2: Create /api/health Basic Endpoint","description":"Create basic health check endpoint at /api/health","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-06T17:07:26.508054327+01:00","updated_at":"2025-11-06T17:10:11.246045651+01:00","closed_at":"2025-11-06T17:10:11.246045651+01:00","labels":["docker","health-check"]}
{"id":"ptnextjs-03b1","title":"test-backend-schema: Design Database Schema Tests","description":"Priority: 1","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-04T15:44:30.850855832+01:00","updated_at":"2025-11-04T19:53:44.845354973+01:00","closed_at":"2025-11-04T19:53:44.845354973+01:00"}
{"id":"ptnextjs-03j","title":"[FE-6] Update dashboard products page","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-10T07:45:18.208384758+01:00","updated_at":"2025-12-10T08:15:44.393367187+01:00","closed_at":"2025-12-10T08:15:44.393367187+01:00","dependencies":[{"issue_id":"ptnextjs-03j","depends_on_id":"ptnextjs-6xi","type":"blocks","created_at":"2025-12-10T07:46:08.942034944+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-0616","title":"core-3: Create docker-compose.yml Configuration","description":"Create docker-compose.yml with app service, volumes, and proxy network","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-06T16:56:38.870722283+01:00","updated_at":"2025-11-06T17:05:22.098455108+01:00","closed_at":"2025-11-06T17:05:22.098455108+01:00","labels":["docker","infrastructure"]}
{"id":"ptnextjs-0684","title":"integ-frontend-backend: Connect Frontend to Backend APIs","description":"Priority: 0","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-04T15:44:30.874824069+01:00","updated_at":"2025-11-06T08:57:27.694745341+01:00","closed_at":"2025-11-06T08:57:27.694745341+01:00"}
{"id":"ptnextjs-06e9","title":"valid-documentation: Documentation Update","description":"Priority: 0","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-04T15:44:30.882149095+01:00","updated_at":"2025-11-06T08:57:35.58958079+01:00","closed_at":"2025-11-06T08:57:35.58958079+01:00"}
{"id":"ptnextjs-070","title":"Backend: Add API endpoints for tier downgrade requests","description":"Create vendor portal API endpoints: POST /api/portal/vendors/[id]/tier-downgrade-request (submit downgrade request), GET /api/portal/vendors/[id]/tier-change-request (get current request status for either type), DELETE /api/portal/vendors/[id]/tier-change-request/[requestId] (cancel pending request).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-05T14:40:34.737275948+01:00","updated_at":"2025-12-05T14:42:26.897227743+01:00","closed_at":"2025-12-05T14:42:26.897227743+01:00","dependencies":[{"issue_id":"ptnextjs-070","depends_on_id":"ptnextjs-ju9","type":"blocks","created_at":"2025-12-05T14:41:55.918982802+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-070","depends_on_id":"ptnextjs-0dh","type":"blocks","created_at":"2025-12-05T14:41:56.145282599+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-072","title":"Add user approval email hook and template","description":"Add afterChange hook to Users collection to send email when status changes to 'approved'. Create user-approved.html template with dashboard link and instructions to complete profile.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-03T17:17:10.307775462+01:00","updated_at":"2025-12-03T18:57:53.559706785+01:00","closed_at":"2025-12-03T18:57:53.559706785+01:00","dependencies":[{"issue_id":"ptnextjs-072","depends_on_id":"ptnextjs-c0c","type":"blocks","created_at":"2025-12-03T17:18:14.583508586+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-077e","title":"E2E Test Suite: Tier Downgrade Request Workflow","description":"## Overview\nE2E test suite for vendor-initiated tier downgrade request workflow with data handling.\n\n## Test File\n`tests/e2e/tier-downgrade-request-workflow.spec.ts`\n\n## Test Coverage\n\n### Suite 1: Vendor Downgrade Request Submission\n**Test 1.1: Submit tier downgrade request (tier2 → tier1)**\n- Login as tier2 vendor\n- Navigate to subscription management\n- Request downgrade to tier1\n- Provide downgrade reason\n- Select data retention option\n- Verify API call succeeds\n- Verify warning messages displayed\n\n**Test 1.2: Data retention options presented**\n- Verify 'archive', 'delete', and other options shown\n- Verify explanation of each option\n- Verify vendor can select preferred option\n\n**Test 1.3: Downgrade impact preview**\n- Vendor with 3 locations requests tier2→tier1\n- System shows: \"You have 3 locations, tier1 allows 1\"\n- Vendor selects which location to keep\n- Other locations marked for archival/deletion\n\n**Test 1.4: Cannot request upgrade via downgrade endpoint**\n- Vendor tries to request higher tier via downgrade API\n- Verify validation prevents this\n\n### Suite 2: Admin Downgrade Approval\n**Test 2.1: Admin views downgrade request with impact summary**\n- Admin views pending downgrade request\n- Sees vendor's reason\n- Sees data retention choice\n- Sees impact summary (X locations affected, etc.)\n\n**Test 2.2: Admin approves downgrade with data migration**\n- Admin approves tier2→tier1 downgrade\n- System archives excess locations (keeps 1)\n- Vendor tier updated\n- Request status updated to approved\n- Verify data migration logged\n\n**Test 2.3: Admin rejects downgrade**\n- Admin rejects downgrade request\n- Provides rejection reason\n- Vendor tier unchanged\n- No data modified\n\n### Suite 3: Data Handling\n**Test 3.1: Archive data on downgrade**\n- Vendor with 'archive' option approved for downgrade\n- Excess locations moved to archived status\n- Archived data queryable but not public\n- Verify data retained in database\n\n**Test 3.2: Delete data on downgrade**\n- Vendor with 'delete' option approved for downgrade\n- Excess locations deleted permanently\n- Verify data removed from database\n- Verify cascade deletes handled\n\n**Test 3.3: Restore archived data on re-upgrade**\n- Vendor downgrades (data archived)\n- Later upgrades back to original tier\n- Archived data restored\n- Verify data integrity maintained\n\n**Test 3.4: Location limit enforcement after downgrade**\n- Vendor downgraded from tier2 to tier1\n- Tries to add 2nd location\n- Verify tier restriction prevents addition\n- Error message shown\n\n### Suite 4: Edge Cases\n**Test 4.1: Downgrade with active promotions**\n- Tier3 vendor has active promotions\n- Requests downgrade to tier2\n- System warns about promotion deactivation\n- After approval, promotions deactivated\n\n**Test 4.2: Multiple downgrades (tier3 → tier2 → tier1)**\n- Vendor downgrades from tier3 to tier2\n- After approval, requests tier2 to tier1\n- Verify both requests handled correctly\n- Verify cumulative data impact\n\n**Test 4.3: Concurrent upgrade and downgrade requests**\n- Vendor with pending downgrade tries to request upgrade\n- Verify system prevents duplicate/conflicting requests\n\n## Test Helpers\n- `seedVendorWithMultipleLocations(tier, locationCount)`\n- `submitDowngradeRequest(vendorId, targetTier, options)`\n- `approveDowngradeRequest(requestId)`\n- `getArchivedData(vendorId, dataType)`\n\n## Acceptance Criteria\n- [ ] All downgrade request submission tests passing\n- [ ] All admin approval tests passing\n- [ ] All data handling tests passing (archive, delete, restore)\n- [ ] Edge case tests passing\n- [ ] Data migration verified in database\n- [ ] Audit logs captured\n- [ ] Test helpers implemented\n- [ ] Tests run reliably in CI","status":"closed","priority":3,"issue_type":"task","created_at":"2025-11-04T14:06:39.597066098+01:00","updated_at":"2025-12-06T18:15:37.26706063+01:00","closed_at":"2025-12-06T18:15:37.26706063+01:00","labels":["e2e","testing","tier-downgrade"],"dependencies":[{"issue_id":"ptnextjs-077e","depends_on_id":"ptnextjs-897c","type":"blocks","created_at":"2025-11-04T14:06:39.607336826+01:00","created_by":"edwin"}]}
{"id":"ptnextjs-0a0","title":"[FE-4] Create useVendorProducts SWR hook","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-10T07:45:15.126896231+01:00","updated_at":"2025-12-10T08:00:56.314813009+01:00","closed_at":"2025-12-10T08:00:56.314813009+01:00","dependencies":[{"issue_id":"ptnextjs-0a0","depends_on_id":"ptnextjs-7hs","type":"blocks","created_at":"2025-12-10T07:46:06.852416739+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-0b57","title":"integ-api-contract: API Contract Validation","description":"Priority: 0","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-04T15:44:30.873525582+01:00","updated_at":"2025-11-06T08:57:26.460779554+01:00","closed_at":"2025-11-06T08:57:26.460779554+01:00"}
{"id":"ptnextjs-0b83","title":"Add authentication middleware for vendor dashboard routes","description":"The vendor dashboard (/vendor/dashboard/*) is accessible without authentication. Need to add Next.js middleware to redirect unauthenticated users to login page. This is a security vulnerability. File: middleware.ts. Affects Test 3.5","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-11-03T13:57:13.59065283+01:00","updated_at":"2025-11-03T18:53:38.36827733+01:00","closed_at":"2025-11-03T18:53:38.36827733+01:00","labels":["auth","middleware","security"]}
{"id":"ptnextjs-0d8","title":"Update BlogPosts schema to use upload relationship for featured image","description":"Change featuredImage field from type 'text' to type 'upload' with relationTo 'media' in payload/collections/BlogPosts.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-24T19:56:44.15013531+01:00","updated_at":"2025-11-24T20:00:33.510213542+01:00","closed_at":"2025-11-24T20:00:33.510213542+01:00","labels":["cms","schema"]}
{"id":"ptnextjs-0d99","title":"Unit Tests: Tier Upgrade Request API Endpoints","description":"## Overview\nUnit tests for tier upgrade request API endpoints using Jest.\n\n## Test Files\n\n### 1. Vendor Endpoints Tests\n`__tests__/api/portal/tier-upgrade-request.test.ts`\n\n**Test Suite: POST /api/portal/vendors/[id]/tier-upgrade-request**\n- ✓ Successfully creates upgrade request\n- ✓ Returns 401 if not authenticated\n- ✓ Returns 403 if not vendor's own account\n- ✓ Returns 400 if no requested tier provided\n- ✓ Returns 400 if invalid tier value\n- ✓ Returns 400 if requested tier not higher than current\n- ✓ Returns 409 if pending request already exists\n- ✓ Validates vendor exists\n- ✓ Creates request with correct data structure\n- ✓ Sets status to 'pending'\n- ✓ Records timestamp\n\n**Test Suite: GET /api/portal/vendors/[id]/tier-upgrade-request**\n- ✓ Returns current pending request if exists\n- ✓ Returns most recent request if no pending\n- ✓ Returns 401 if not authenticated\n- ✓ Returns 403 if not vendor's own account\n- ✓ Returns 404 if no requests found\n- ✓ Includes all request fields (status, dates, reason if rejected)\n\n**Test Suite: DELETE /api/portal/vendors/[id]/tier-upgrade-request**\n- ✓ Cancels pending request successfully\n- ✓ Returns 401 if not authenticated\n- ✓ Returns 403 if not vendor's own account\n- ✓ Returns 404 if no pending request\n- ✓ Returns 400 if request already approved/rejected\n- ✓ Updates status to 'cancelled'\n- ✓ Records cancellation timestamp\n\n### 2. Admin Endpoints Tests\n`__tests__/api/admin/tier-upgrade-requests.test.ts`\n\n**Test Suite: GET /api/admin/tier-upgrade-requests**\n- ✓ Returns list of upgrade requests\n- ✓ Returns 401 if not authenticated\n- ✓ Returns 403 if not admin\n- ✓ Filters by status (pending/approved/rejected)\n- ✓ Filters by date range\n- ✓ Filters by vendor ID\n- ✓ Pagination works correctly\n- ✓ Sorting works (by date, vendor name)\n- ✓ Includes vendor details in response\n\n**Test Suite: PUT /api/admin/tier-upgrade-requests/[id]/approve**\n- ✓ Approves request and updates vendor tier\n- ✓ Returns 401 if not authenticated\n- ✓ Returns 403 if not admin\n- ✓ Returns 404 if request not found\n- ✓ Returns 400 if request already approved/rejected\n- ✓ Updates request status to 'approved'\n- ✓ Records review timestamp\n- ✓ Records admin user ID\n- ✓ Updates vendor tier atomically\n- ✓ Logs tier change for audit\n\n**Test Suite: PUT /api/admin/tier-upgrade-requests/[id]/reject**\n- ✓ Rejects request with reason\n- ✓ Returns 401 if not authenticated\n- ✓ Returns 403 if not admin\n- ✓ Returns 404 if request not found\n- ✓ Returns 400 if request already approved/rejected\n- ✓ Returns 400 if no rejection reason provided\n- ✓ Updates request status to 'rejected'\n- ✓ Stores rejection reason\n- ✓ Records review timestamp\n- ✓ Records admin user ID\n- ✓ Does not update vendor tier\n\n### 3. Service Layer Tests\n`__tests__/services/TierUpgradeRequestService.test.ts`\n\n**Test Suite: TierUpgradeRequestService**\n- ✓ createRequest() validates input\n- ✓ createRequest() checks for duplicate pending requests\n- ✓ createRequest() validates tier upgrade only\n- ✓ getRequestByVendor() returns correct request\n- ✓ approveRequest() updates both request and vendor\n- ✓ approveRequest() validates request can be approved\n- ✓ rejectRequest() requires rejection reason\n- ✓ rejectRequest() does not update vendor tier\n- ✓ cancelRequest() only works on pending requests\n- ✓ listRequests() supports filtering and pagination\n\n## Test Helpers\n- Mock Payload CMS for database operations\n- Mock authentication context\n- Factory functions for creating test data:\n  - `createMockVendor()`\n  - `createMockUpgradeRequest()`\n  - `createMockAdmin()`\n\n## Acceptance Criteria\n- [ ] All vendor endpoint tests written and passing\n- [ ] All admin endpoint tests written and passing\n- [ ] Service layer tests written and passing\n- [ ] 100% code coverage for new API routes\n- [ ] Tests use proper mocking/isolation\n- [ ] Tests are fast (\u003c500ms per suite)\n- [ ] CI integration working","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-04T14:05:22.734497386+01:00","updated_at":"2025-12-06T18:13:18.542829386+01:00","closed_at":"2025-12-06T18:13:18.542829386+01:00","labels":["api","testing","unit"],"dependencies":[{"issue_id":"ptnextjs-0d99","depends_on_id":"ptnextjs-bbec","type":"blocks","created_at":"2025-11-04T14:05:22.753838625+01:00","created_by":"edwin"}]}
{"id":"ptnextjs-0dh","title":"Tier Downgrade System - Parent Epic","description":"Implement tier downgrade functionality for vendors. This includes vendor-initiated downgrade requests with admin approval, admin manual tier changes, and profile rendering that respects the new tier (hiding tier-restricted content without deleting CMS data).","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-05T14:40:19.003576181+01:00","updated_at":"2025-12-05T14:42:15.971478579+01:00","closed_at":"2025-12-05T14:42:15.971478579+01:00"}
{"id":"ptnextjs-0e8b","title":"Implement Admin Vendor Approval API Endpoint","description":"Create POST /api/admin/vendors/[id]/approve endpoint to approve pending vendors. Updates user status from 'pending' to 'approved'. Unlocks 90% of test scenarios.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-03T09:14:47.288618875+01:00","updated_at":"2025-11-03T09:32:33.820491751+01:00","closed_at":"2025-11-03T09:32:33.820491751+01:00","labels":["api","backend","e2e","testing"]}
{"id":"ptnextjs-0mg","title":"[BE-4] Implement GET/PUT/DELETE /api/portal/vendors/[id]/products/[productId]","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-10T07:44:58.666378402+01:00","updated_at":"2025-12-10T07:56:10.769849258+01:00","closed_at":"2025-12-10T07:56:10.769849258+01:00","dependencies":[{"issue_id":"ptnextjs-0mg","depends_on_id":"ptnextjs-12v","type":"blocks","created_at":"2025-12-10T07:45:55.604135321+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-0mg","depends_on_id":"ptnextjs-7lq","type":"blocks","created_at":"2025-12-10T07:45:55.617952163+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-0o5w","title":"Fix Playwright fixture error in tier-downgrade-request-workflow.spec.ts","description":"3 tests failing with: 'context and page fixtures are not supported in beforeAll'. Move authentication logic from beforeAll to beforeEach or use browser fixture directly. Quick fix - low effort, 3 tests impacted.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-10T15:41:05.733303648+01:00","updated_at":"2025-12-10T16:42:47.301897856+01:00","closed_at":"2025-12-10T16:42:47.301897856+01:00"}
{"id":"ptnextjs-0vjj","title":"[E2E Quarantine] Delete or update vendor-dashboard-flow.spec.ts (3 tests)","description":"Root Cause: Tests use outdated registration form structure. VendorRegistrationForm.tsx has been updated but tests were not.\n\nAffected Tests:\n- vendor-dashboard-flow.spec.ts (3 tests)\n\nAnalysis:\nThese tests appear to duplicate functionality already covered by vendor-onboarding tests:\n- 01-registration.spec.ts\n- 03-authentication.spec.ts\n- Other dashboard tests\n\nRecommendation: DELETE these tests rather than update them.\n\nJustification:\n1. Registration flow already tested in 01-registration.spec.ts\n2. Dashboard access already tested in other files\n3. Profile edit flow likely covered elsewhere\n4. Maintaining duplicate tests increases maintenance burden\n\nAction Required: Review and confirm deletion\n\nImpact: ~3 redundant tests can be removed\n\nPriority: P3 (Quick decision - delete or keep)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-11T13:35:06.928381623+01:00","updated_at":"2025-12-11T13:48:48.376322581+01:00","closed_at":"2025-12-11T13:48:48.376322581+01:00"}
{"id":"ptnextjs-12v","title":"[BE-1] Create ProductService business logic","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-10T07:44:48.199373844+01:00","updated_at":"2025-12-10T07:51:56.474025934+01:00","closed_at":"2025-12-10T07:51:56.474025934+01:00"}
{"id":"ptnextjs-1765","title":"test-backend-vendor-api: Design Vendor API Endpoint Tests","description":"Priority: 1","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-04T15:44:30.858222211+01:00","updated_at":"2025-11-04T19:53:44.851649308+01:00","closed_at":"2025-11-04T19:53:44.851649308+01:00"}
{"id":"ptnextjs-1ck","title":"[Downgrade] Frontend: TierDowngradeRequestForm component","description":"Create form for vendors to request downgrade:\n- Tier selector (only lower tiers than current)\n- Warning about features that will be hidden (not deleted)\n- Optional notes field\n- Confirmation dialog with clear messaging\n- Similar UX to TierUpgradeRequestForm","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-05T14:42:57.867900259+01:00","updated_at":"2025-12-05T15:41:08.502252879+01:00","closed_at":"2025-12-05T15:41:08.502252879+01:00","dependencies":[{"issue_id":"ptnextjs-1ck","depends_on_id":"ptnextjs-897c","type":"blocks","created_at":"2025-12-05T14:43:31.862748974+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-1ck","depends_on_id":"ptnextjs-c05","type":"blocks","created_at":"2025-12-05T14:43:42.739403652+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-1e5b","title":"Security enhancements for tier-upgrade system","description":"HIGH Priority: 1) Add CSP headers and security headers (X-Content-Type-Options, X-Frame-Options), 2) Add rate limiting (10 req/min), 3) Backend min length validation (rejection reason 10 chars, vendor notes 20 chars). MEDIUM: 4) Standardize error messages, 5) Production secret validation. Files: middleware.ts (create), reject/route.ts, TierUpgradeRequestService.ts, payload.config.ts","acceptance_criteria":"CSP headers implemented, rate limiting active, all input validation enforced backend, error messages standardized, security score 90/100+","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-06T09:48:27.473592308+01:00","updated_at":"2025-11-06T10:11:07.124064293+01:00","closed_at":"2025-11-06T10:11:07.124069753+01:00","labels":["high-priority","pre-merge","security","tier-upgrade-system"]}
{"id":"ptnextjs-1e96","title":"BE-1: Install exceljs Dependency","description":"Install exceljs@^4.4.0 library for Excel file generation and parsing. Includes TypeScript types verification.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-06T21:59:48.94996231+01:00","updated_at":"2025-11-06T21:59:58.4205734+01:00","closed_at":"2025-11-06T21:59:58.4205734+01:00","labels":["backend","dependencies","excel-import-export"]}
{"id":"ptnextjs-1f1","title":"[Downgrade] Backend: Wire email notifications","description":"Add email triggers for tier changes:\n- afterCreate hook on tier requests (admin notification)\n- afterChange hook for approval/rejection (vendor notification)\n- Vendor collection afterChange for direct admin tier changes\nFollow patterns from existing TierUpgradeRequests collection hooks.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-05T14:43:12.357341761+01:00","updated_at":"2025-12-05T15:51:53.280951126+01:00","closed_at":"2025-12-05T15:51:53.280951126+01:00","dependencies":[{"issue_id":"ptnextjs-1f1","depends_on_id":"ptnextjs-897c","type":"blocks","created_at":"2025-12-05T14:43:32.016917708+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-1f1","depends_on_id":"ptnextjs-p30","type":"blocks","created_at":"2025-12-05T14:43:42.815856934+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-1f7q","title":"Fix vendor profile save persistence bug in dashboard","description":"E2E test vendor-dashboard.spec.ts:87 (Edit Basic Info) fails because:\n- Profile edit form submits successfully (HTTP 200)\n- Success toast displays\n- But after page reload, data reverts to original values\n\nRoot cause: The PUT /api/portal/vendors/[id] endpoint returns success but data isn't persisting, likely due to:\n1. Caching/ISR not invalidating properly after update\n2. Or the API returning 200 without actually saving to database\n\nTest file: tests/e2e/vendor-dashboard.spec.ts:87\nSymptom: Expected 'Updated Name {timestamp}' but received original seed name\n\nThis is an APPLICATION bug, not a test isolation issue.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-11T15:34:12.283094728+01:00","updated_at":"2025-12-11T16:23:44.980761471+01:00","closed_at":"2025-12-11T16:23:44.980761471+01:00"}
{"id":"ptnextjs-2bf7","title":"BE-3: Create ExcelTemplateService","description":"Generate tier-appropriate Excel templates with headers, examples, data validation, and instructions worksheet. Includes 33 unit tests with 90%+ coverage. Features: styled headers, frozen rows, dropdown validation, number ranges, text length limits.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-06T22:00:08.395276627+01:00","updated_at":"2025-11-06T22:00:18.19713157+01:00","closed_at":"2025-11-06T22:00:18.19713157+01:00","labels":["backend","excel-import-export","services","testing"]}
{"id":"ptnextjs-2c24","title":"test-e2e-admin: Admin Workflow E2E Tests","description":"Priority: 0","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-04T15:44:30.877425018+01:00","updated_at":"2025-11-06T08:57:30.827278102+01:00","closed_at":"2025-11-06T08:57:30.827278102+01:00"}
{"id":"ptnextjs-2er","title":"Frontend: Add admin direct tier change UI","description":"Add tier change dropdown/modal in Payload admin vendor edit page OR create custom admin page at /admin/vendors/[id]/tier. Allow admin to directly change vendor tier with confirmation dialog. No request needed - immediate tier change with audit log entry.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-05T14:41:06.1405652+01:00","updated_at":"2025-12-05T14:42:26.993889148+01:00","closed_at":"2025-12-05T14:42:26.993889148+01:00","dependencies":[{"issue_id":"ptnextjs-2er","depends_on_id":"ptnextjs-vqq","type":"blocks","created_at":"2025-12-05T14:41:56.013165598+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-2er","depends_on_id":"ptnextjs-0dh","type":"blocks","created_at":"2025-12-05T14:41:56.232514018+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-2f0f","title":"E2E Test Suite 02: Admin Approval Workflow","description":"Implement 5 test scenarios for admin approval. Requires admin approval API. File: tests/e2e/vendor-onboarding/02-admin-approval.spec.ts","acceptance_criteria":"✓ Test 2.1: Admin login and navigation to pending vendors\n✓ Test 2.2: Admin approves vendor\n✓ Test 2.3: Pending vendor cannot login (403 forbidden)\n✓ Test 2.4: Approved vendor can login successfully\n✓ Test 2.5: Admin rejects vendor application\n✓ Uses admin approval API endpoint\n✓ Verifies status changes in database\n✓ Tests rejection workflow with reason\n✓ All 5 tests passing\n✓ Execution time \u003c 4 minutes","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-03T09:15:16.128406137+01:00","updated_at":"2025-11-03T09:49:32.605720137+01:00","closed_at":"2025-11-03T09:49:32.605720137+01:00","labels":["e2e","smoke-test","testing"],"dependencies":[{"issue_id":"ptnextjs-2f0f","depends_on_id":"ptnextjs-0e8b","type":"blocks","created_at":"2025-11-03T09:15:16.135678303+01:00","created_by":"edwin"}]}
{"id":"ptnextjs-2j1","title":"[FE-2] Create ProductDeleteDialog component","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-10T07:44:50.565324099+01:00","updated_at":"2025-12-10T07:50:03.659597311+01:00","closed_at":"2025-12-10T07:50:03.659597311+01:00"}
{"id":"ptnextjs-2xe","title":"Extract authenticateVendor to shared middleware utility","description":"Duplicated authenticateVendor function exists in tier-downgrade-request/route.ts:20-59 and [requestId]/route.ts:20-58. Extract to shared middleware for consistency and maintainability.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-05T16:08:18.113484756+01:00","updated_at":"2025-12-05T16:14:55.144223347+01:00","closed_at":"2025-12-05T16:14:55.144223347+01:00"}
{"id":"ptnextjs-32b","title":"Update transformPayloadBlogPost to handle media relationship for featured image","description":"Update the transform function in lib/payload-cms-data-service.ts to properly handle featuredImage as a media relationship object instead of a string URL","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-24T19:56:53.469604928+01:00","updated_at":"2025-11-24T20:01:08.563296692+01:00","closed_at":"2025-11-24T20:01:08.563296692+01:00","labels":["backend"]}
{"id":"ptnextjs-350a","title":"Implement Vendor Reviews with hCaptcha Integration","description":"✅ IMPLEMENTATION COMPLETE AND VERIFIED\n\n**Bug Found \u0026 Fixed**:\n- Modal dialog was not rendering when reviews array was empty\n- Fixed by restructuring component to always render Dialog outside conditional\n\n**Test Results**:\n✅ Modal opens successfully\n✅ Form fields render correctly\n✅ hCaptcha widget appears\n✅ Review submission works\n✅ User confirmed feature is working\n\n**Files Modified**:\n- payload/collections/Vendors.ts (added vendorReviews field)\n- app/api/vendors/[slug]/reviews/route.ts (API endpoints)\n- components/vendors/VendorReviews.tsx (component with fix)\n- app/(site)/vendors/[slug]/page.tsx (integration)\n- lib/types.ts (VendorReview interface)\n\n**Evidence**: Playwright tests pass, screenshots saved to evidence directory","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-11-04T08:41:04.626204019+01:00","updated_at":"2025-11-04T09:07:39.075574903+01:00","closed_at":"2025-11-04T08:52:43.465554687+01:00","labels":["api","frontend","hcaptcha","reviews","vendor"]}
{"id":"ptnextjs-3567","title":"core-2: Create Multi-Stage Dockerfile","description":"Create multi-stage Dockerfile with deps, builder, and runner stages","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-06T16:56:36.909383236+01:00","updated_at":"2025-11-06T17:03:47.571715254+01:00","closed_at":"2025-11-06T17:03:47.571715254+01:00","labels":["docker","infrastructure"]}
{"id":"ptnextjs-3bd9","title":"Fix Vendor Profile Form Save Button Bug","description":"Profile form save button gets stuck in 'Saving...' state. Button is disabled and API call either hangs, fails silently, or response not handled. Test shows button disabled with text 'Saving...' after click but no PUT request completes.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-11-03T10:56:21.167912464+01:00","updated_at":"2025-11-03T11:49:28.835655386+01:00","closed_at":"2025-11-03T11:49:28.835655386+01:00","labels":["bug","e2e","frontend"]}
{"id":"ptnextjs-3c99","title":"impl-frontend-status: Implement UpgradeRequestStatusCard Component","description":"Priority: 1","notes":"Component implemented with all 23 tests passing. Features: status badges, tier display, cancel functionality, date formatting, rejection reasons","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-04T15:44:30.867721799+01:00","updated_at":"2025-11-04T22:41:48.05502744+01:00","closed_at":"2025-11-04T22:41:48.05502744+01:00"}
{"id":"ptnextjs-3cf0","title":"E2E Test Suite: Vendor Tier Upgrade Request Workflow","description":"## Overview\nComprehensive E2E test suite for vendor-initiated tier upgrade request workflow.\n\n## Test File\n`tests/e2e/tier-upgrade-request-workflow.spec.ts`\n\n## Test Coverage\n\n### Suite 1: Vendor Request Submission\n**Test 1.1: View tier upgrade options**\n- Login as free tier vendor\n- Navigate to subscription/upgrade page\n- Verify tier comparison table displays\n- Verify current tier is highlighted\n- Verify upgrade options shown (tier1, tier2, tier3)\n\n**Test 1.2: Submit tier upgrade request (free → tier1)**\n- Free tier vendor submits tier1 upgrade request\n- Verify API call succeeds (201)\n- Verify success toast displayed\n- Verify request status shows \"pending\"\n- Verify request appears in subscription tab\n\n**Test 1.3: Cannot submit duplicate request**\n- Vendor with pending request tries to submit another\n- Verify API returns 400/409 conflict\n- Verify error toast displayed\n- Verify UI prevents duplicate submission\n\n**Test 1.4: Cannot request downgrade**\n- Tier2 vendor tries to request tier1 or free\n- Verify UI prevents selection or API rejects\n- Verify error message shown\n\n**Test 1.5: Cancel pending upgrade request**\n- Vendor with pending request clicks cancel\n- Verify confirmation dialog\n- Verify DELETE API call succeeds\n- Verify request status updates\n- Verify can submit new request after cancellation\n\n### Suite 2: Admin Approval Workflow\n**Test 2.1: Admin views pending upgrade requests**\n- Login as admin\n- Navigate to upgrade requests management\n- Verify pending requests list displays\n- Verify filters work (status, date, tier)\n- Verify sorting works\n\n**Test 2.2: Admin approves upgrade request**\n- Admin selects pending request\n- Clicks \"Approve\" button\n- Verifies confirmation modal\n- Confirms approval\n- Verify API call succeeds\n- Verify request status updates to \"approved\"\n- Verify vendor tier updated in database\n- Verify success toast shown\n\n**Test 2.3: Verify vendor tier updated after approval**\n- Query vendor from database\n- Verify tier field updated\n- Verify tier badge displays new tier\n- Verify tier-gated features now accessible\n\n**Test 2.4: Admin rejects upgrade request**\n- Admin selects pending request\n- Clicks \"Reject\" button\n- Enters rejection reason\n- Confirms rejection\n- Verify API call succeeds\n- Verify request status updates to \"rejected\"\n- Verify rejection reason stored\n- Verify vendor tier unchanged\n\n**Test 2.5: Vendor sees rejection reason**\n- Login as rejected vendor\n- Navigate to subscription page\n- Verify request status shows \"rejected\"\n- Verify rejection reason displayed\n- Verify can submit new request\n\n### Suite 3: End-to-End Happy Path\n**Test 3.1: Complete upgrade flow (free → tier1 → tier2)**\n- Free tier vendor submits tier1 request\n- Admin approves\n- Verify tier1 features unlock\n- Vendor verifies new features accessible\n- Vendor submits tier2 request\n- Admin approves\n- Verify tier2 features unlock\n\n**Test 3.2: Complete upgrade flow with rejection**\n- Vendor submits upgrade request\n- Admin rejects with reason\n- Vendor sees rejection\n- Vendor submits new request with corrections\n- Admin approves\n- Verify tier updated\n\n### Suite 4: Edge Cases \u0026 Validation\n**Test 4.1: Request expires/stale handling**\n- Create old pending request (if time-based expiry implemented)\n- Verify system handles appropriately\n\n**Test 4.2: Concurrent request handling**\n- Vendor submits request\n- Admin starts review\n- Vendor tries to cancel\n- Verify race condition handling\n\n**Test 4.3: Invalid tier requests**\n- Try requesting invalid tier values\n- Verify validation\n\n**Test 4.4: Unauthorized access**\n- Non-admin tries to approve request\n- Verify 403 error\n- Different vendor tries to view another's request\n- Verify 403 error\n\n## Test Helpers Needed\n- `seedVendorWithUpgradeRequest()` - Create vendor with pending request\n- `approveUpgradeRequest(vendorId)` - Admin helper to approve\n- `rejectUpgradeRequest(vendorId, reason)` - Admin helper to reject\n- `getUpgradeRequestStatus(vendorId)` - Get current request status\n\n## Acceptance Criteria\n- [ ] All vendor request submission tests passing\n- [ ] All admin approval workflow tests passing\n- [ ] End-to-end happy path tests passing\n- [ ] Edge case tests passing\n- [ ] Test helpers implemented\n- [ ] Uses seed API helpers pattern\n- [ ] Proper cleanup between tests\n- [ ] Tests run reliably in CI\n- [ ] Screenshot evidence captured for key steps","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-04T14:04:55.822403677+01:00","updated_at":"2025-12-06T18:30:59.745748+01:00","closed_at":"2025-12-06T18:30:59.745748+01:00","labels":["e2e","testing","tier-upgrade"],"dependencies":[{"issue_id":"ptnextjs-3cf0","depends_on_id":"ptnextjs-bbec","type":"blocks","created_at":"2025-11-04T14:04:55.829076784+01:00","created_by":"edwin"},{"issue_id":"ptnextjs-3cf0","depends_on_id":"ptnextjs-6909","type":"blocks","created_at":"2025-11-04T14:04:55.830714204+01:00","created_by":"edwin"}]}
{"id":"ptnextjs-3ph","title":"Task 5: Add Payload CMS Hooks for Tier Upgrade Requests","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-03T11:59:24.366710924+01:00","updated_at":"2025-12-03T12:18:37.144347479+01:00","closed_at":"2025-12-03T12:18:37.144347479+01:00","dependencies":[{"issue_id":"ptnextjs-3ph","depends_on_id":"ptnextjs-fec","type":"blocks","created_at":"2025-12-03T11:59:37.030624011+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-3ph","depends_on_id":"ptnextjs-5f5","type":"blocks","created_at":"2025-12-03T11:59:37.063398452+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-40x","title":"Replace any type with proper Payload Where type in TierUpgradeRequestService","description":"TierUpgradeRequestService.ts uses 'any' type for whereClause at lines 424, 454, 528. Replace with proper Payload CMS Where type for better type safety.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-05T16:08:45.307517788+01:00","updated_at":"2025-12-05T16:17:13.580071178+01:00","closed_at":"2025-12-05T16:17:13.580071178+01:00"}
{"id":"ptnextjs-41p","title":"Use dynamic year in email templates","description":"All 10 email templates have © 2024 hardcoded in the footer. Email functions pass CURRENT_YEAR variable but templates don't use it. Replace hardcoded year with {{CURRENT_YEAR}} in all templates to prevent outdated copyright after Dec 31, 2024.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-03T19:12:07.127287217+01:00","updated_at":"2025-12-03T19:21:10.308668738+01:00","closed_at":"2025-12-03T19:21:10.308668738+01:00"}
{"id":"ptnextjs-4570","title":"test-e2e-vendor: Vendor Workflow E2E Tests","description":"Priority: 0","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-04T15:44:30.876131977+01:00","updated_at":"2025-11-06T08:57:28.892141018+01:00","closed_at":"2025-11-06T08:57:28.892141018+01:00"}
{"id":"ptnextjs-45dc","title":"Fix integration tests requiring environment","description":"api-admin-endpoints.test.ts: Requires dev server running. tier-access-control.test.tsx: Mock setup incorrect (15 failures). profile-locations-display.test.tsx: Missing testid (12 failures).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-07T22:27:39.030572097+01:00","updated_at":"2025-11-08T07:21:55.675214849+01:00","closed_at":"2025-11-08T07:21:55.675214849+01:00","labels":["environment","integration","testing"]}
{"id":"ptnextjs-46t","title":"[Downgrade] Documentation: Update CLAUDE.md","description":"Update documentation:\n- Add tier downgrade workflow to email notification table\n- Document new API endpoints\n- Document profile rendering behavior (hide vs delete)\n- Update validation rules section","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-05T14:43:22.815360112+01:00","updated_at":"2025-12-05T15:53:29.987658633+01:00","closed_at":"2025-12-05T15:53:29.987658633+01:00","dependencies":[{"issue_id":"ptnextjs-46t","depends_on_id":"ptnextjs-897c","type":"blocks","created_at":"2025-12-05T14:43:32.097838737+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-46t","depends_on_id":"ptnextjs-1f1","type":"blocks","created_at":"2025-12-05T14:43:42.910121942+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-46t","depends_on_id":"ptnextjs-ha7","type":"blocks","created_at":"2025-12-05T14:43:42.926607784+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-49d","title":"Backend: Create email templates for tier downgrade","description":"Create email templates: tier-downgrade-requested.html (admin notification), tier-downgrade-approved.html (vendor notification with info about hidden features), tier-downgrade-rejected.html (vendor notification with reason). Update EmailService with send functions.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-05T14:41:11.132451872+01:00","updated_at":"2025-12-05T14:42:27.016152216+01:00","closed_at":"2025-12-05T14:42:27.016152216+01:00","dependencies":[{"issue_id":"ptnextjs-49d","depends_on_id":"ptnextjs-0dh","type":"blocks","created_at":"2025-12-05T14:41:56.248575616+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-4g4","title":"Enhanced Vendor Onboarding Workflow","description":"Implement complete vendor onboarding workflow with user approval, profile submission, and email notifications. Includes hCaptcha on registration, simplified registration form, profile submission flow, and 8 email triggers.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-03T17:16:39.648231525+01:00","updated_at":"2025-12-03T19:00:08.197219798+01:00","closed_at":"2025-12-03T19:00:08.197219798+01:00"}
{"id":"ptnextjs-4uz","title":"Task 6: Testing \u0026 Verification","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-03T11:59:27.437518568+01:00","updated_at":"2025-12-03T12:25:21.321974952+01:00","closed_at":"2025-12-03T12:25:21.321974952+01:00","dependencies":[{"issue_id":"ptnextjs-4uz","depends_on_id":"ptnextjs-h2b","type":"blocks","created_at":"2025-12-03T11:59:37.093408618+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-4uz","depends_on_id":"ptnextjs-3ph","type":"blocks","created_at":"2025-12-03T11:59:37.123308493+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-522d","title":"Performance optimizations for tier-upgrade system","description":"Implement performance optimizations: 1) Fix admin endpoint URL (DONE), 2) Remove redundant API call in UpgradeRequestStatusCard, 3) Add database field selection, 4) Implement pagination, 5) Add response caching. Target: Page load 350ms-\u003e150ms, API 60ms-\u003e35ms, Payload 85KB-\u003e45KB","acceptance_criteria":"Page load \u003c150ms, API response \u003c35ms, payload \u003c45KB, all optimizations implemented and tested","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-06T09:48:01.848161244+01:00","updated_at":"2025-11-06T10:11:08.368985548+01:00","closed_at":"2025-11-06T10:11:08.368989798+01:00","labels":["performance","pre-merge","tier-upgrade-system"],"dependencies":[{"issue_id":"ptnextjs-522d","depends_on_id":"ptnextjs-c810","type":"blocks","created_at":"2025-11-06T09:48:01.855051447+01:00","created_by":"edwin"}]}
{"id":"ptnextjs-55e8","title":"Refactor admin approval tests to use seed helpers","description":"Tests 2.2 and 2.5 call admin API directly without auth. Should use seed helper pattern instead. Files: tests/e2e/vendor-onboarding/02-admin-approval.spec.ts, tests/e2e/helpers/seed-api-helpers.ts. Affects Tests 2.2, 2.5","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-03T13:57:17.893038222+01:00","updated_at":"2025-11-03T19:07:35.551320531+01:00","closed_at":"2025-11-03T19:07:35.551320531+01:00","labels":["admin","refactor","testing"]}
{"id":"ptnextjs-583a","title":"Add tier badge display to public vendor profiles","description":"Tier/featured badges not rendering on public vendor profile pages. Need to add SubscriptionTierBadge component to VendorHero.tsx. Affects Test 10.4. File: components/vendors/VendorHero.tsx","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-11-03T13:57:20.382812995+01:00","updated_at":"2025-11-03T19:00:03.487361205+01:00","closed_at":"2025-11-03T19:00:03.487361205+01:00","labels":["public-profile","tier-badge","ui"]}
{"id":"ptnextjs-59ec","title":"Fix Registration Redirect Timeout","description":"Root cause found: Registration API was calling hashPassword() for validation, which hashes with bcrypt (12 rounds, ~250-500ms). This happened before Payload CMS also hashed the password, resulting in ~500ms-1s wasted on double hashing. Fixed by making validatePasswordStrength() public and calling it directly instead.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-11-03T10:56:07.557996686+01:00","updated_at":"2025-11-03T11:42:47.291376781+01:00","closed_at":"2025-11-03T11:42:47.291376781+01:00","labels":["bug","e2e","performance"]}
{"id":"ptnextjs-5a07","title":"E2E Test Suite 04: Free Tier Profile","description":"Implement 6 test scenarios for free tier profile setup. File: tests/e2e/vendor-onboarding/04-free-tier-profile.spec.ts","acceptance_criteria":"✓ Test 4.1: Dashboard loads with free tier badge\n✓ Test 4.2: Edit and save basic info (name, description, phone)\n✓ Test 4.3: Free tier cannot access tier 1+ fields (upgrade prompt shown)\n✓ Test 4.4: Upload logo image successfully\n✓ Test 4.5: Form validation errors display correctly\n✓ Test 4.6: Single location limit enforced\n✓ Verifies tier restrictions working\n✓ Tests file upload functionality\n✓ All 6 tests passing\n✓ Execution time \u003c 4 minutes","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-03T09:15:18.286073074+01:00","updated_at":"2025-11-03T09:49:32.608290758+01:00","closed_at":"2025-11-03T09:49:32.608290758+01:00","labels":["core-workflow","e2e","testing"]}
{"id":"ptnextjs-5b1","title":"Frontend: Update vendor subscription dashboard page","description":"Update app/(site)/vendor/dashboard/subscription/page.tsx to show both upgrade and downgrade options. Display current tier, pending request status (either type), and appropriate form based on current tier. Hide downgrade option for free tier vendors.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-05T14:40:54.920384899+01:00","updated_at":"2025-12-05T14:42:26.959248431+01:00","closed_at":"2025-12-05T14:42:26.959248431+01:00","dependencies":[{"issue_id":"ptnextjs-5b1","depends_on_id":"ptnextjs-070","type":"blocks","created_at":"2025-12-05T14:41:55.973699213+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-5b1","depends_on_id":"ptnextjs-e9u","type":"blocks","created_at":"2025-12-05T14:41:55.987878756+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-5b1","depends_on_id":"ptnextjs-0dh","type":"blocks","created_at":"2025-12-05T14:41:56.195365183+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-5b34","title":"Add Image Fixtures for E2E Tests","description":"Add team-member.jpg, case-study-1.jpg, product-image.jpg to tests/fixtures/ directory.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-03T09:14:52.038875892+01:00","updated_at":"2025-11-03T09:43:54.368491541+01:00","closed_at":"2025-11-03T09:43:54.368491541+01:00","labels":["fixtures","testing"]}
{"id":"ptnextjs-5f5","title":"Task 3: Create HTML Email Templates","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-03T11:59:20.556589564+01:00","updated_at":"2025-12-03T12:07:55.025219949+01:00","closed_at":"2025-12-03T12:07:55.025219949+01:00","dependencies":[{"issue_id":"ptnextjs-5f5","depends_on_id":"ptnextjs-cpp","type":"blocks","created_at":"2025-12-03T11:59:36.933251819+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-662c","title":"Tier Upgrade System - Pre-Merge Quality Push","description":"Complete all remaining quality tasks before merging tier-upgrade-request-system to main. Includes unit test fixes, performance optimizations, security hardening, ESLint cleanup, and comprehensive QA validation. Target: Production-ready state with security score 90+, performance score 85+, all tests passing.","acceptance_criteria":"All child tasks completed, TypeScript compiles, build succeeds, security validated, performance optimized, ready for production deployment","status":"closed","priority":0,"issue_type":"epic","created_at":"2025-11-06T09:48:43.741734127+01:00","updated_at":"2025-11-06T10:11:20.316690647+01:00","closed_at":"2025-11-06T10:11:20.316693453+01:00","labels":["epic","pre-merge","quality","tier-upgrade-system"],"dependencies":[{"issue_id":"ptnextjs-662c","depends_on_id":"ptnextjs-c810","type":"blocks","created_at":"2025-11-06T09:48:43.750587237+01:00","created_by":"edwin"},{"issue_id":"ptnextjs-662c","depends_on_id":"ptnextjs-522d","type":"blocks","created_at":"2025-11-06T09:48:43.752391467+01:00","created_by":"edwin"},{"issue_id":"ptnextjs-662c","depends_on_id":"ptnextjs-1e5b","type":"blocks","created_at":"2025-11-06T09:48:43.754142051+01:00","created_by":"edwin"},{"issue_id":"ptnextjs-662c","depends_on_id":"ptnextjs-bbe0","type":"blocks","created_at":"2025-11-06T09:48:43.755898638+01:00","created_by":"edwin"},{"issue_id":"ptnextjs-662c","depends_on_id":"ptnextjs-ac78","type":"blocks","created_at":"2025-11-06T09:48:43.757486285+01:00","created_by":"edwin"}]}
{"id":"ptnextjs-6754","title":"E2E Test Suite 03: Vendor Authentication","description":"Implement 5 test scenarios for authentication flow. File: tests/e2e/vendor-onboarding/03-authentication.spec.ts","acceptance_criteria":"✓ Test 3.1: Successful login with valid credentials\n✓ Test 3.2: Login fails with invalid credentials (401)\n✓ Test 3.3: Session persistence after page reload\n✓ Test 3.4: Logout functionality clears session\n✓ Test 3.5: Protected route access redirects to login\n✓ Tests cookie-based authentication\n✓ Verifies session cookies\n✓ Tests unauthorized access handling\n✓ All 5 tests passing\n✓ Execution time \u003c 3 minutes","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-03T09:15:17.292344208+01:00","updated_at":"2025-11-03T09:49:32.607042142+01:00","closed_at":"2025-11-03T09:49:32.607042142+01:00","labels":["e2e","smoke-test","testing"]}
{"id":"ptnextjs-6837","title":"BE-2: Create Field Mapping Configuration","description":"Create lib/config/excel-field-mappings.ts with 28 vendor fields, tier-based access control, validation rules, and 9 helper functions. Includes 48 unit tests with 100% coverage.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-06T21:59:58.457337586+01:00","updated_at":"2025-11-06T22:00:08.363661071+01:00","closed_at":"2025-11-06T22:00:08.363661071+01:00","labels":["backend","configuration","excel-import-export"]}
{"id":"ptnextjs-6858","title":"pre-2: Create Integration Strategy","description":"Priority: 1","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-04T15:44:30.847760079+01:00","updated_at":"2025-11-04T19:53:44.843970776+01:00","closed_at":"2025-11-04T19:53:44.843970776+01:00"}
{"id":"ptnextjs-6909","title":"Implement Vendor Dashboard Tier Upgrade UI","description":"## Overview\nCreate vendor dashboard UI for requesting tier upgrades and viewing upgrade request status.\n\n## Current State\n- ✅ `UpgradePromptCard` exists - shows \"Contact Sales\" button\n- ✅ `TierUpgradePrompt` exists - shows upgrade needed for locked features\n- ✅ Dashboard shows tier badge via `SubscriptionTierBadge`\n- ❌ No `/vendor/dashboard/subscription` route\n- ❌ No request submission form\n- ❌ No request status tracking UI\n- ❌ Upgrade buttons currently link to mailto or non-existent /subscription/upgrade\n\n## Requirements\n\n### New Components to Create\n\n1. **TierUpgradeRequestForm** (`components/dashboard/TierUpgradeRequestForm.tsx`)\n   - Tier selection (tier1, tier2, tier3 based on current)\n   - Vendor notes textarea (why upgrade is needed)\n   - Submit upgrade request button\n   - Integration with POST API endpoint\n   - Validation: prevent duplicate pending requests\n\n2. **UpgradeRequestStatusCard** (`components/dashboard/UpgradeRequestStatusCard.tsx`)\n   - Show pending request details (requested tier, date, notes)\n   - Display status badge (pending/approved/rejected)\n   - Show rejection reason if rejected\n   - Cancel request button (if status=pending)\n   - Timeline/history of request\n\n3. **TierComparisonTable** (`components/TierComparisonTable.tsx`)\n   - Responsive table showing features by tier\n   - Highlight current tier\n   - Show which features unlock at each tier\n   - Feature availability checkmarks\n   - Pricing information (if available)\n\n### Routes to Create\n- `app/(site)/vendor/dashboard/subscription/page.tsx`\n  - Main subscription management page\n  - Shows current tier status\n  - TierComparisonTable\n  - TierUpgradeRequestForm OR UpgradeRequestStatusCard (based on pending request)\n  - Links to pricing page\n\n### Components to Update\n- **UpgradePromptCard**: Change \"Contact Sales\" to navigate to `/vendor/dashboard/subscription`\n- **Dashboard sidebar**: Add link to subscription page\n- **Dashboard main**: Update tier card upgrade buttons to link to subscription page\n\n### User Flows\n1. **Request Upgrade Flow:**\n   - Vendor clicks \"Upgrade\" from dashboard or locked feature\n   - Navigates to /vendor/dashboard/subscription\n   - Views tier comparison table\n   - Selects desired tier\n   - Enters notes explaining why\n   - Submits request\n   - Sees confirmation toast\n   - Status card shows \"pending\"\n\n2. **View Status Flow:**\n   - Vendor with pending request navigates to subscription page\n   - Sees UpgradeRequestStatusCard showing pending status\n   - Can cancel request if needed\n   - After admin approval/rejection, sees updated status\n\n3. **Approved Flow:**\n   - Status updates to \"approved\"\n   - Tier badge updates throughout dashboard\n   - Features unlock automatically\n   - Success message displayed\n\n## API Integration\n- POST /api/portal/vendors/[id]/tier-upgrade-request - Submit request\n- GET /api/portal/vendors/[id]/tier-upgrade-request - Check status\n- DELETE /api/portal/vendors/[id]/tier-upgrade-request/[requestId] - Cancel\n\n## Acceptance Criteria\n- [ ] TierUpgradeRequestForm component created and functional\n- [ ] UpgradeRequestStatusCard component created\n- [ ] TierComparisonTable component created\n- [ ] `/vendor/dashboard/subscription` route created\n- [ ] UpgradePromptCard updated to link to subscription page\n- [ ] Dashboard sidebar includes subscription link\n- [ ] API integration for submitting requests works\n- [ ] API integration for viewing request status works\n- [ ] API integration for canceling requests works\n- [ ] Toast notifications for success/error\n- [ ] Responsive design (mobile-friendly)\n- [ ] Proper loading and error states\n- [ ] Cannot submit duplicate pending requests\n- [ ] Form validation (tier selection, notes)","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-11-04T14:04:08.340699635+01:00","updated_at":"2025-12-06T18:12:47.761277427+01:00","closed_at":"2025-12-06T18:12:47.761277427+01:00","labels":["dashboard","frontend","ui"],"dependencies":[{"issue_id":"ptnextjs-6909","depends_on_id":"ptnextjs-bbec","type":"blocks","created_at":"2025-11-04T14:04:08.376206698+01:00","created_by":"edwin"}]}
{"id":"ptnextjs-69ec","title":"Add Docker environment check for docker-stack tests","description":"docker-stack.test.ts: 33 tests hang without Docker. Add describe.skipIf(!isDockerAvailable) wrapper or environment detection.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-11-07T22:27:41.577588713+01:00","updated_at":"2025-11-08T07:21:54.417640988+01:00","closed_at":"2025-11-08T07:21:54.417640988+01:00","labels":["docker","integration","testing"]}
{"id":"ptnextjs-6dd1","title":"E2E Test Suite 07: Tier 2 Location Management","description":"Implement 7 test scenarios for multi-location management. File: tests/e2e/vendor-onboarding/07-tier2-locations.spec.ts","acceptance_criteria":"✓ Test 7.1: Add first location as headquarters with HQ flag\n✓ Test 7.2: Add multiple locations (up to 10 for tier 2)\n✓ Test 7.3: Edit existing location details\n✓ Test 7.4: Delete location with confirmation\n✓ Test 7.5: Geocoding integration (address to coordinates)\n✓ Test 7.6: Map preview with location markers (Leaflet)\n✓ Test 7.7: Location limit enforcement (10 max for tier 2)\n✓ Tests geocoding API integration\n✓ Verifies map display working\n✓ Enforces tier 2 location limits\n✓ All 7 tests passing\n✓ Execution time \u003c 5 minutes","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-03T09:15:21.936667914+01:00","updated_at":"2025-11-03T12:28:32.492162619+01:00","closed_at":"2025-11-03T12:28:32.492162619+01:00","labels":["advanced-features","e2e","testing"]}
{"id":"ptnextjs-6kj","title":"Add user rejection email hook and template","description":"Add to Users afterChange hook to send email when status changes to 'rejected'. Create user-rejected.html template with rejection reason and next steps.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-03T17:17:15.545074428+01:00","updated_at":"2025-12-03T18:57:53.572935603+01:00","closed_at":"2025-12-03T18:57:53.572935603+01:00","dependencies":[{"issue_id":"ptnextjs-6kj","depends_on_id":"ptnextjs-c0c","type":"blocks","created_at":"2025-12-03T17:18:14.598212072+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-6w1","title":"[FE-1] Create ProductCard component","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-10T07:45:08.14957328+01:00","updated_at":"2025-12-10T07:54:43.64544221+01:00","closed_at":"2025-12-10T07:54:43.64544221+01:00","dependencies":[{"issue_id":"ptnextjs-6w1","depends_on_id":"ptnextjs-7lq","type":"blocks","created_at":"2025-12-10T07:46:06.82376727+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-6xi","title":"[FE-5] Create ProductList container component","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-10T07:45:16.744953734+01:00","updated_at":"2025-12-10T08:14:09.525256847+01:00","closed_at":"2025-12-10T08:14:09.525256847+01:00","dependencies":[{"issue_id":"ptnextjs-6xi","depends_on_id":"ptnextjs-6w1","type":"blocks","created_at":"2025-12-10T07:46:07.948785213+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-6xi","depends_on_id":"ptnextjs-2j1","type":"blocks","created_at":"2025-12-10T07:46:07.962730551+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-6xi","depends_on_id":"ptnextjs-9y2","type":"blocks","created_at":"2025-12-10T07:46:07.978431927+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-6xi","depends_on_id":"ptnextjs-0a0","type":"blocks","created_at":"2025-12-10T07:46:07.992504902+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-74d6","title":"Fix location/map feature tests (5 test files, ~50 failing tests)","description":"LocationsDisplaySection.test.tsx: 11 failures - Leaflet mock spreading boolean props to DOM. LocationSearchFilter.test.tsx: 15 failures - Missing loading state, result handling. LocationResultSelector.test.tsx: Missing Dialog description. locations-workflow.test.tsx: Test timeout. location-search-workflow.test.tsx: 5 failures - event handlers not wired.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-07T22:27:36.824871996+01:00","updated_at":"2025-11-08T07:21:56.791509334+01:00","closed_at":"2025-11-08T07:21:56.791509334+01:00","labels":["locations","maps","testing"]}
{"id":"ptnextjs-7c9a","title":"core-1: Write Docker Stack Integration Tests (RED)","description":"Write comprehensive integration tests for Docker stack BEFORE implementation (TDD RED phase)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-06T16:56:35.362256955+01:00","updated_at":"2025-11-06T17:02:06.328549387+01:00","closed_at":"2025-11-06T17:02:06.328549387+01:00","labels":["docker","tdd","testing"]}
{"id":"ptnextjs-7dc5","title":"impl-backend-admin-api: Implement Admin API Endpoints","description":"Priority: 1","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-04T15:44:30.862104783+01:00","updated_at":"2025-11-04T19:54:03.815982919+01:00","closed_at":"2025-11-04T19:54:03.815982919+01:00"}
{"id":"ptnextjs-7hs","title":"[BE-3] Implement GET/POST /api/portal/vendors/[id]/products","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-10T07:44:57.703431618+01:00","updated_at":"2025-12-10T07:56:02.162890575+01:00","closed_at":"2025-12-10T07:56:02.162890575+01:00","dependencies":[{"issue_id":"ptnextjs-7hs","depends_on_id":"ptnextjs-12v","type":"blocks","created_at":"2025-12-10T07:45:54.633078261+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-7hs","depends_on_id":"ptnextjs-7lq","type":"blocks","created_at":"2025-12-10T07:45:54.64595007+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-7lq","title":"[BE-2] Create product validation schemas (Zod)","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-10T07:44:49.110989712+01:00","updated_at":"2025-12-10T07:52:03.627393703+01:00","closed_at":"2025-12-10T07:52:03.627393703+01:00"}
{"id":"ptnextjs-8093","title":"E2E Test Suite 05: Tier Upgrade Flow","description":"Implement 6 test scenarios for tier upgrades. Requires tier upgrade API. File: tests/e2e/vendor-onboarding/05-tier-upgrade.spec.ts","acceptance_criteria":"✓ Test 5.1: View tier upgrade options and pricing\n✓ Test 5.2: Upgrade from free to tier 1 (simulated payment)\n✓ Test 5.3: Tier 1 features unlocked after upgrade\n✓ Test 5.4: Upgrade from tier 1 to tier 2\n✓ Test 5.5: Upgrade to tier 3 enterprise\n✓ Test 5.6: Cannot downgrade tier (validation prevents)\n✓ Uses tier upgrade API endpoint\n✓ Verifies feature unlocking\n✓ All 6 tests passing\n✓ Execution time \u003c 5 minutes","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-03T09:15:19.626191134+01:00","updated_at":"2025-11-03T10:49:46.941129214+01:00","closed_at":"2025-11-03T10:49:46.941129214+01:00","labels":["core-workflow","e2e","testing"],"dependencies":[{"issue_id":"ptnextjs-8093","depends_on_id":"ptnextjs-9505","type":"blocks","created_at":"2025-11-03T09:15:19.635277924+01:00","created_by":"edwin"}]}
{"id":"ptnextjs-81b8","title":"Fix ISR configuration for dynamic vendor public profiles","description":"Public vendor profile pages (/vendors/[slug]/) return 404 for test-seeded vendors. Need to add dynamicParams=true and revalidate config. File: app/(site)/vendors/[slug]/page.tsx. Affects Test 4.4","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-11-03T13:57:15.693968665+01:00","updated_at":"2025-11-03T18:58:08.471505692+01:00","closed_at":"2025-11-03T18:58:08.471505692+01:00","labels":["ISR","public-profile","routing"]}
{"id":"ptnextjs-8515","title":"impl-frontend-form: Implement TierUpgradeRequestForm Component","description":"Priority: 1","notes":"All 28 tests passing. Fixed: 1) Added jsdom polyfills (hasPointerCapture, scrollIntoView), 2) Updated selectTier helper to handle multiple text matches (hidden option + visible portal span), 3) Added mode:'onBlur' to form for real-time validation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-04T15:44:30.866307435+01:00","updated_at":"2025-11-04T22:29:15.492682479+01:00","closed_at":"2025-11-04T22:29:15.492682479+01:00"}
{"id":"ptnextjs-870a","title":"valid-performance: Performance Validation","description":"Priority: 0","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-04T15:44:30.880257444+01:00","updated_at":"2025-11-06T08:57:34.081943763+01:00","closed_at":"2025-11-06T08:57:34.081943763+01:00"}
{"id":"ptnextjs-8868","title":"test-backend-service: Design Service Layer Tests","description":"Priority: 1","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-04T15:44:30.855609952+01:00","updated_at":"2025-11-04T19:53:44.849134754+01:00","closed_at":"2025-11-04T19:53:44.849134754+01:00"}
{"id":"ptnextjs-897c","title":"Add Tier Downgrade Request Workflow","description":"## Overview\nExtend tier request system to support vendor-initiated tier downgrade requests with admin approval.\n\n## Context\nUnlike upgrades which are generally straightforward, downgrades require careful handling:\n- Data retention concerns (what happens to tier-locked content?)\n- Feature access revocation\n- Existing data migration/archival\n- Potential cancellation flow integration\n\n## Requirements\n\n### Database Schema Extension\nExtend `tier_upgrade_requests` to support downgrades:\n- Rename to `tier_change_requests` (or keep current name but support both)\n- Add `changeType` field: 'upgrade' | 'downgrade'\n- Add `dataRetentionOption` field:\n  - 'archive' - Archive tier-locked content, restore on re-upgrade\n  - 'delete' - Permanently delete tier-locked content\n  - 'downgrade_features_only' - Keep data but disable features\n\n### Vendor API Endpoints\n- `POST /api/portal/vendors/[id]/tier-downgrade-request`\n  - Submit downgrade request\n  - Require downgrade reason from vendor\n  - Present data retention options\n  - Validate requested tier is lower than current\n\n### Admin Review\n- Admin sees downgrade requests separately or with type indicator\n- Admin must explicitly acknowledge data implications\n- Admin can add notes about data handling\n\n### Data Migration Service\n- Create `TierDowngradeService` to handle:\n  - Identify tier-locked data (locations, team members, etc.)\n  - Archive or delete based on vendor selection\n  - Create migration report\n  - Log all data changes for audit\n\n### Business Rules\n1. **Location Limits:**\n   - Tier3→Tier2: Keep up to 10 locations\n   - Tier2→Tier1: Keep up to 1 location\n   - Tier1→Free: Remove all locations\n   - Vendor chooses which to keep (if applicable)\n\n2. **Team Members:**\n   - Tier1→Free: Archive team member profiles\n\n3. **Promotions:**\n   - Tier3→lower: Deactivate active promotions\n\n4. **Content:**\n   - Case studies, certifications: Archive or keep (TBD)\n\n### UI Components\n- `TierDowngradeRequestForm` with:\n  - Downgrade reason textarea (required)\n  - Data retention options\n  - Clear warnings about feature loss\n  - Confirmation checkboxes\n- Admin review shows:\n  - Downgrade reason\n  - Data retention choice\n  - Impact summary (X locations, Y team members, etc.)\n\n## Acceptance Criteria\n- [ ] Database schema supports downgrades\n- [ ] Vendor can request downgrade with reason\n- [ ] Vendor selects data retention option\n- [ ] Admin can approve/reject downgrade requests\n- [ ] TierDowngradeService migrates/archives data\n- [ ] Tier-locked data handled per vendor selection\n- [ ] Audit log of all data changes\n- [ ] Clear UI warnings about feature loss\n- [ ] Edge cases handled (e.g., active promotions)\n- [ ] Rollback capability if downgrade fails\n\n## Open Questions\n1. Should downgrades be instant or scheduled (end of billing period)?\n2. How long should archived data be retained?\n3. Should vendors be able to restore archived data on re-upgrade?\n4. What's the grace period for data deletion?","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-11-04T14:06:12.963743963+01:00","updated_at":"2025-12-05T15:53:39.573342187+01:00","closed_at":"2025-12-05T15:53:39.573342187+01:00","labels":["api","backend","tier-management"],"dependencies":[{"issue_id":"ptnextjs-897c","depends_on_id":"ptnextjs-bbec","type":"blocks","created_at":"2025-11-04T14:06:12.985283953+01:00","created_by":"edwin"}]}
{"id":"ptnextjs-8df5","title":"Implement Admin Panel Tier Upgrade Request Management UI","description":"## Overview\nCreate admin panel UI for managing vendor tier upgrade requests.\n\n## Current State\n- ✅ Admin panel exists at `/admin` (Payload CMS)\n- ✅ Admin can change tiers via API: `PUT /api/admin/vendors/[id]/tier`\n- ❌ No admin UI for viewing upgrade requests\n- ❌ No approval/rejection workflow UI\n- ❌ No upgrade request queue\n\n## Implementation Decision Required\n\n**Option A: Payload CMS Custom Collection View (RECOMMENDED)**\n- Add `tier_upgrade_requests` as Payload collection\n- Use Payload's built-in admin UI for list/detail views\n- Add custom cell components for status badges\n- Add custom actions for approve/reject buttons\n- Pros: Integrates seamlessly with existing /admin, leverages Payload's UI\n- Cons: Limited to Payload's UI patterns\n\n**Option B: Separate Admin Portal Page**\n- Create `app/(site)/admin-portal/tier-requests/page.tsx`\n- Build custom UI with full control\n- Separate from Payload admin\n- Pros: Full UI flexibility, custom workflows\n- Cons: Separate auth, doesn't leverage Payload admin\n\n**RECOMMENDATION: Option A** - Use Payload's admin UI with custom components\n\n## Requirements (Option A - Payload Admin)\n\n### Payload Collection Configuration\nIn `payload/collections/TierUpgradeRequests.ts`:\n- Enable admin UI with custom components\n- Add custom cell for status badge\n- Add custom actions for approve/reject\n- Configure list view with filters\n\n### Custom Components\n1. **StatusBadgeCell** (`payload/components/StatusBadgeCell.tsx`)\n   - Custom cell component for status column\n   - Color-coded badges (pending=yellow, approved=green, rejected=red)\n\n2. **ApproveRejectActions** (`payload/components/ApproveRejectActions.tsx`)\n   - Custom action buttons in row/detail view\n   - Approve button with confirmation\n   - Reject button with reason modal\n   - Only show if status=pending\n\n3. **TierChangePreview** (`payload/components/TierChangePreview.tsx`)\n   - Shows current tier → requested tier\n   - Vendor information summary\n   - Request notes from vendor\n\n### Admin Workflows\n1. **View Requests:**\n   - Admin logs into /admin\n   - Navigates to \"Tier Upgrade Requests\" collection\n   - Sees list with columns: Vendor, Current, Requested, Status, Date, Actions\n   - Can filter by status (pending/approved/rejected)\n   - Can sort by date, vendor name\n\n2. **Approve Request:**\n   - Click \"Approve\" button on pending request\n   - Confirmation modal shows tier change details\n   - Admin confirms\n   - API call to approve endpoint\n   - Vendor tier updated\n   - Success toast shown\n   - Request status updates to approved\n\n3. **Reject Request:**\n   - Click \"Reject\" button on pending request\n   - Modal prompts for rejection reason (required)\n   - Admin enters reason and confirms\n   - API call to reject endpoint\n   - Request status updates to rejected\n   - Success toast shown\n   - Vendor can see rejection reason\n\n## Alternative Approach (If Option B chosen)\nCreate standalone pages:\n- `app/(site)/admin-portal/tier-requests/page.tsx` - List view\n- `app/(site)/admin-portal/tier-requests/[id]/page.tsx` - Detail view\n- Components: TierUpgradeRequestsList, TierUpgradeRequestModal, etc.\n\n## API Integration\n- GET /api/admin/tier-upgrade-requests - List with filters\n- PUT /api/admin/tier-upgrade-requests/[id]/approve - Approve\n- PUT /api/admin/tier-upgrade-requests/[id]/reject - Reject\n\n## Acceptance Criteria\n- [ ] Decide on implementation approach (Option A vs B)\n- [ ] TierUpgradeRequests collection configured in Payload admin\n- [ ] Custom status badge cell component\n- [ ] Custom approve/reject action components\n- [ ] List view shows all requests with filtering\n- [ ] Detail view shows full request information\n- [ ] Approve action updates tier and request status\n- [ ] Reject action requires reason and stores it\n- [ ] Only pending requests show approve/reject actions\n- [ ] Admin sees vendor details (company, email, current tier)\n- [ ] Toast notifications for success/error\n- [ ] Proper error handling\n- [ ] Admin-only access (auth check)","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-11-04T14:04:28.609286967+01:00","updated_at":"2025-12-06T18:12:48.86004735+01:00","closed_at":"2025-12-06T18:12:48.86004735+01:00","labels":["admin","frontend","ui"],"dependencies":[{"issue_id":"ptnextjs-8df5","depends_on_id":"ptnextjs-bbec","type":"blocks","created_at":"2025-11-04T14:04:28.626894284+01:00","created_by":"edwin"}]}
{"id":"ptnextjs-92b","title":"[Downgrade] Frontend: Update subscription dashboard","description":"Update vendor dashboard subscription page:\n- Show both upgrade and downgrade options\n- Display any pending request (either type)\n- Clear messaging about current tier features\n- Hide downgrade option for free tier vendors","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-05T14:42:57.88720421+01:00","updated_at":"2025-12-05T15:51:53.264422716+01:00","closed_at":"2025-12-05T15:51:53.264422716+01:00","dependencies":[{"issue_id":"ptnextjs-92b","depends_on_id":"ptnextjs-897c","type":"blocks","created_at":"2025-12-05T14:43:31.887717557+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-92b","depends_on_id":"ptnextjs-c05","type":"blocks","created_at":"2025-12-05T14:43:42.753242565+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-92b","depends_on_id":"ptnextjs-1ck","type":"blocks","created_at":"2025-12-05T14:43:42.77048357+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-93g","title":"Simplify vendor registration form","description":"Reduce registration form to only: contact email, company name, website. Remove other fields - they will be filled during profile completion.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-03T17:16:54.990804721+01:00","updated_at":"2025-12-03T17:33:45.757965055+01:00","closed_at":"2025-12-03T17:33:45.757965055+01:00"}
{"id":"ptnextjs-9505","title":"Implement Admin Tier Upgrade API Endpoint","description":"Create PUT /api/admin/vendors/[id]/tier endpoint to upgrade vendor tiers without payment. Required for testing tier1/tier2/tier3 features.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-03T09:14:48.317155781+01:00","updated_at":"2025-11-03T09:32:33.824008265+01:00","closed_at":"2025-11-03T09:32:33.824008265+01:00","labels":["api","backend","e2e","testing"]}
{"id":"ptnextjs-9678","title":"impl-admin-actions: Implement Admin Approve/Reject UI Components","description":"Priority: 1","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-04T15:44:30.872202103+01:00","updated_at":"2025-11-05T08:03:48.749949067+01:00","closed_at":"2025-11-05T08:03:48.749949067+01:00"}
{"id":"ptnextjs-96a9","title":"pre-1: Perform Codebase Analysis","description":"Codebase analysis for tier upgrade request system. Agent: context-fetcher. Time: 3-5 min. See .agent-os/specs/2025-11-04-tier-upgrade-request-system/tasks/task-pre-1.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-04T15:43:48.505371576+01:00","updated_at":"2025-11-04T19:53:44.841266834+01:00","closed_at":"2025-11-04T19:53:44.841266834+01:00","labels":["pre-execution","tier-upgrade"]}
{"id":"ptnextjs-9ay","title":"Testing: E2E tests for tier downgrade workflow","description":"Write Playwright E2E tests covering: vendor submits downgrade request, admin sees request in queue, admin approves/rejects, vendor profile updates correctly (features hidden not deleted), vendor dashboard reflects new tier. Test both vendor-initiated and admin-initiated tier changes.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-05T14:41:35.492872093+01:00","updated_at":"2025-12-05T14:42:27.095778932+01:00","closed_at":"2025-12-05T14:42:27.095778932+01:00","dependencies":[{"issue_id":"ptnextjs-9ay","depends_on_id":"ptnextjs-5b1","type":"blocks","created_at":"2025-12-05T14:41:56.05374315+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-9ay","depends_on_id":"ptnextjs-k19","type":"blocks","created_at":"2025-12-05T14:41:56.066633478+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-9ay","depends_on_id":"ptnextjs-uwj","type":"blocks","created_at":"2025-12-05T14:41:56.082264361+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-9ay","depends_on_id":"ptnextjs-0dh","type":"blocks","created_at":"2025-12-05T14:41:56.315894612+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-9xq","title":"[BE-5] Implement PATCH /api/portal/vendors/[id]/products/[productId]/publish","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-10T07:45:00.177051263+01:00","updated_at":"2025-12-10T07:54:30.666695779+01:00","closed_at":"2025-12-10T07:54:30.666695779+01:00","dependencies":[{"issue_id":"ptnextjs-9xq","depends_on_id":"ptnextjs-12v","type":"blocks","created_at":"2025-12-10T07:45:56.879080711+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-9y2","title":"[FE-3] Create ProductForm component (Sheet)","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-10T07:45:08.925814804+01:00","updated_at":"2025-12-10T07:58:14.805991129+01:00","closed_at":"2025-12-10T07:58:14.805991129+01:00","dependencies":[{"issue_id":"ptnextjs-9y2","depends_on_id":"ptnextjs-7lq","type":"blocks","created_at":"2025-12-10T07:46:06.838602841+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-a114","title":"Implement or fix product management UI route","description":"Test 9.2 expects /vendor/dashboard/products route but may not exist or may be integrated into profile tabs. Need to either create route or update tests to match current architecture. Affects Tests 9.2-9.6","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-11-03T13:57:19.31770536+01:00","updated_at":"2025-11-03T19:06:38.908891033+01:00","closed_at":"2025-11-03T19:06:38.908891033+01:00","labels":["product-management","routing","ui"]}
{"id":"ptnextjs-a2o","title":"[Downgrade] Frontend: Admin direct tier change","description":"Add admin ability to directly change vendor tier:\n- Tier dropdown on vendor edit page (Payload admin)\n- OR custom admin page /admin/vendors/[id]/tier\n- Confirmation dialog with impact info\n- No request needed - immediate change","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-05T14:42:57.925390095+01:00","updated_at":"2025-12-05T15:41:08.52807741+01:00","closed_at":"2025-12-05T15:41:08.52807741+01:00","dependencies":[{"issue_id":"ptnextjs-a2o","depends_on_id":"ptnextjs-897c","type":"blocks","created_at":"2025-12-05T14:43:31.940101654+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-a2o","depends_on_id":"ptnextjs-cw6","type":"blocks","created_at":"2025-12-05T14:43:42.802477384+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-ac78","title":"Final QA validation and integration testing","description":"Comprehensive pre-merge validation: 1) Run full test suite (npm test \u0026\u0026 npm run test:e2e), 2) TypeScript compilation check, 3) Production build verification, 4) Manual QA of critical workflows (vendor submit request, admin approve/reject, cancel), 5) Browser testing (Chrome, Firefox, Safari), 6) Mobile responsiveness check","acceptance_criteria":"All tests pass, build succeeds, manual QA complete, no regressions, ready for merge","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-06T09:48:30.908646195+01:00","updated_at":"2025-11-06T10:11:19.277298386+01:00","closed_at":"2025-11-06T10:11:19.277301703+01:00","labels":["pre-merge","qa","tier-upgrade-system","validation"],"dependencies":[{"issue_id":"ptnextjs-ac78","depends_on_id":"ptnextjs-c810","type":"blocks","created_at":"2025-11-06T09:48:30.916860568+01:00","created_by":"edwin"},{"issue_id":"ptnextjs-ac78","depends_on_id":"ptnextjs-522d","type":"blocks","created_at":"2025-11-06T09:48:30.918500188+01:00","created_by":"edwin"}]}
{"id":"ptnextjs-b439","title":"E2E Test Suite 01: Vendor Registration","description":"Implement 8 test scenarios for vendor registration flow. File: tests/e2e/vendor-onboarding/01-registration.spec.ts","acceptance_criteria":"✓ Test 1.1: Successful registration with all fields\n✓ Test 1.2: Validation errors for missing fields\n✓ Test 1.3: Invalid email format validation\n✓ Test 1.4: Password mismatch validation\n✓ Test 1.5: Weak password rejection\n✓ Test 1.6: Duplicate email detection\n✓ Test 1.7: Submit button disabled during submission\n✓ Test 1.8: Terms and conditions acceptance\n✓ Uses helper functions (no duplicated code)\n✓ Captures screenshots on failure\n✓ Execution time \u003c 5 minutes","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-03T09:15:14.318244264+01:00","updated_at":"2025-11-03T09:49:32.603047413+01:00","closed_at":"2025-11-03T09:49:32.603047413+01:00","labels":["e2e","smoke-test","testing"]}
{"id":"ptnextjs-b44c","title":"impl-backend-types: Implement TypeScript Type Definitions","description":"Priority: 1","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-04T15:44:30.854236807+01:00","updated_at":"2025-11-04T19:53:44.847861921+01:00","closed_at":"2025-11-04T19:53:44.847861921+01:00"}
{"id":"ptnextjs-b7s","title":"Set approvedAt/rejectedAt timestamps in Users afterChange hook","description":"The Users collection has approvedAt and rejectedAt date fields, but the afterChange hook only sends emails when status changes - it doesn't set these timestamps. The hook should: 1) Set approvedAt=now when status changes to 'approved', 2) Set rejectedAt=now when status changes to 'rejected'. This provides audit trail for when users were approved/rejected.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-03T19:14:23.454385206+01:00","updated_at":"2025-12-03T19:21:14.105619693+01:00","closed_at":"2025-12-03T19:21:14.105619693+01:00"}
{"id":"ptnextjs-b85d","title":"E2E Test Suite 09: Product Management","description":"Implement 7 test scenarios for product CRUD. File: tests/e2e/vendor-onboarding/09-product-management.spec.ts","acceptance_criteria":"✓ Test 9.1: Access product management (tier 2+ only)\n✓ Test 9.2: View product list for vendor\n✓ Test 9.3: Add new product with all fields\n✓ Test 9.4: Edit existing product details\n✓ Test 9.5: Delete product with confirmation\n✓ Test 9.6: Publish/unpublish product toggle\n✓ Test 9.7: Product categories assignment (multi-select)\n✓ Product CRUD operations working\n✓ Tier 2+ restriction enforced\n✓ All 7 tests passing\n✓ Execution time \u003c 5 minutes","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-03T09:15:24.602009309+01:00","updated_at":"2025-11-03T12:36:25.799972555+01:00","closed_at":"2025-11-03T12:36:25.799972555+01:00","labels":["advanced-features","e2e","testing"],"dependencies":[{"issue_id":"ptnextjs-b85d","depends_on_id":"ptnextjs-f9d4","type":"blocks","created_at":"2025-11-03T09:15:24.610051175+01:00","created_by":"edwin"}]}
{"id":"ptnextjs-ba45","title":"Excel Vendor Import/Export Feature","description":"Complete Excel-based vendor data import/export system with tier-based templates, validation, and atomic imports. Enables vendors to bulk upload/update company info, products, and locations. Spec: .agent-os/specs/2025-11-06-excel-vendor-import-export/","notes":"VAL-1: Security Validation COMPLETED - Fixed all npm vulnerabilities (0 remaining) - Created comprehensive security test suite (12 tests) - Generated security validation report - Verified all OWASP Top 10 mitigations - Zero critical/high vulnerabilities found. Remaining: VAL-2 Performance, VAL-3 Browser Testing, VAL-4 Documentation, VAL-5 Acceptance Verification. Status: 29/32 tasks complete (91%)","status":"closed","priority":0,"issue_type":"epic","created_at":"2025-11-06T22:00:31.515411181+01:00","updated_at":"2025-12-07T09:26:19.159598902+01:00","closed_at":"2025-12-07T09:26:19.159598902+01:00","labels":["backend","critical-path","excel-import-export","frontend"]}
{"id":"ptnextjs-bbe0","title":"Clean up ESLint warnings in dashboard components","description":"Remove unused imports and variables from dashboard components: BrandStoryForm.tsx, CaseStudiesManager.tsx, CertificationsAwardsManager.tsx, DashboardSidebar.tsx, ProfileEditTabs.tsx, PromotionPackForm.tsx, TeamMembersManager.tsx, vendors-client.tsx. Fix unescaped entities. Target: 0 ESLint errors (warnings acceptable)","acceptance_criteria":"All ESLint errors resolved, unused imports removed, unescaped entities fixed","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-06T09:48:29.268255322+01:00","updated_at":"2025-11-06T10:11:09.456685907+01:00","closed_at":"2025-11-06T10:11:09.456688773+01:00","labels":["cleanup","code-quality","dashboard"]}
{"id":"ptnextjs-bbec","title":"Implement Vendor Tier Upgrade Request System","description":"## Overview\nImplement a complete vendor-initiated tier upgrade request system that allows vendors to request tier upgrades and admins to approve/reject them.\n\n## Current State\n- ✅ Admin can directly change tiers via `PUT /api/admin/vendors/[id]/tier`\n- ✅ UI components exist: `TierUpgradePrompt`, `UpgradePromptCard`, `SubscriptionTierBadge`\n- ❌ No vendor request submission workflow\n- ❌ No admin approval queue/workflow\n- ❌ No request tracking collection in database\n- ❌ Current flow: Vendor → \"Contact Sales\" mailto link → Manual process\n\n## Requirements\n\n### Database Schema\n- Create `tier_upgrade_requests` collection in Payload CMS with fields:\n  - `id` (primary key)\n  - `vendor` (relationship to vendors collection)\n  - `user` (relationship to users collection)\n  - `currentTier` (free|tier1|tier2|tier3)\n  - `requestedTier` (tier1|tier2|tier3)\n  - `status` (pending|approved|rejected|cancelled)\n  - `requestedAt` (timestamp)\n  - `reviewedAt` (timestamp, nullable)\n  - `reviewedBy` (relationship to users, nullable)\n  - `rejectionReason` (richText, nullable)\n  - `notes` (richText, nullable)\n  - `vendorNotes` (text - why vendor wants upgrade)\n\n### Vendor API Endpoints\n- `POST /api/portal/vendors/[id]/tier-upgrade-request`\n  - Submit upgrade request with vendor notes\n  - Validate: no pending request exists\n  - Validate: requested tier is higher than current\n  - Return request ID and status\n- `GET /api/portal/vendors/[id]/tier-upgrade-request`\n  - Get current/recent upgrade request status\n  - Include rejection reason if rejected\n- `DELETE /api/portal/vendors/[id]/tier-upgrade-request/[requestId]`\n  - Cancel pending request (must be status=pending)\n\n### Admin API Endpoints\n- `GET /api/admin/tier-upgrade-requests`\n  - List all upgrade requests with filters (status, vendor, date range)\n  - Include vendor details (companyName, email, currentTier)\n  - Support pagination and sorting\n- `PUT /api/admin/tier-upgrade-requests/[id]/approve`\n  - Approve request and update vendor tier atomically\n  - Log tier change with admin user ID\n  - Set reviewedAt timestamp\n- `PUT /api/admin/tier-upgrade-requests/[id]/reject`\n  - Reject request with reason (required)\n  - Do NOT update vendor tier\n  - Notify vendor (if notification system available)\n\n## Integration Points\n- Reuse existing `PUT /api/admin/vendors/[id]/tier` for the actual tier update on approval\n- Update existing `UpgradePromptCard` to link to new subscription page\n- Update dashboard upgrade buttons to navigate to request form\n\n## Acceptance Criteria\n- [ ] `tier_upgrade_requests` collection created in `payload.config.ts`\n- [ ] Collection file created: `payload/collections/TierUpgradeRequests.ts`\n- [ ] Vendor can submit tier upgrade request with notes\n- [ ] Vendor can view their request status\n- [ ] Vendor can cancel pending request\n- [ ] Admin can list all upgrade requests with filters\n- [ ] Admin can approve requests (updates vendor tier atomically)\n- [ ] Admin can reject requests with reason\n- [ ] No duplicate pending requests allowed per vendor\n- [ ] Cannot request downgrade (validation enforced)\n- [ ] All endpoints have proper auth/authorization\n- [ ] Request lifecycle properly tracked (timestamps, status changes)","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-11-04T14:03:51.461747689+01:00","updated_at":"2025-11-08T10:22:34.176966768+01:00","closed_at":"2025-11-08T10:22:34.176966768+01:00","labels":["api","backend","database"]}
{"id":"ptnextjs-bc46","title":"Implement Notification System for Tier Upgrade Requests","description":"## Overview\nImplement notification system to inform vendors and admins about tier upgrade request status changes.\n\n## Requirements\n\n### Notification Types\n\n**For Vendors:**\n1. **Request Submitted** - Confirmation that request was received\n2. **Request Approved** - Tier upgrade approved, features unlocked\n3. **Request Rejected** - Request rejected with admin's reason\n4. **Request Cancelled** - Confirmation of cancellation\n\n**For Admins:**\n1. **New Request Received** - New vendor upgrade request pending review\n2. **Request Cancelled** - Vendor cancelled their request\n\n### Notification Channels\n\n**Phase 1 (MVP):**\n- In-app notifications (dashboard bell icon)\n- Email notifications\n\n**Phase 2 (Future):**\n- SMS notifications (optional)\n- Webhook/Slack integration for admins\n\n### Implementation\n\n**Database Schema:**\n- Create `notifications` collection/table:\n  - `id` (primary key)\n  - `userId` (recipient)\n  - `type` (upgrade_request_submitted|approved|rejected|cancelled|new_request)\n  - `title` (notification title)\n  - `message` (notification body)\n  - `read` (boolean)\n  - `metadata` (JSON - request details, vendor info, etc.)\n  - `createdAt` (timestamp)\n\n**Email Templates:**\n- Create email templates in `emails/` directory:\n  - `tier-upgrade-request-submitted.tsx` (vendor)\n  - `tier-upgrade-request-approved.tsx` (vendor)\n  - `tier-upgrade-request-rejected.tsx` (vendor)\n  - `tier-upgrade-request-new.tsx` (admin)\n\n**API Endpoints:**\n- `GET /api/notifications` - Get user's notifications\n- `PUT /api/notifications/[id]/read` - Mark as read\n- `PUT /api/notifications/mark-all-read` - Mark all as read\n- `DELETE /api/notifications/[id]` - Delete notification\n\n**Service Layer:**\n- Create `NotificationService` in `lib/services/`\n  - `createNotification(userId, type, data)`\n  - `sendEmail(userId, template, data)`\n  - `getUserNotifications(userId, filters)`\n  - `markAsRead(notificationId)`\n\n**UI Components:**\n- `NotificationBell` - Header bell icon with unread count\n- `NotificationDropdown` - Dropdown list of recent notifications\n- `NotificationCenter` - Full page view of all notifications\n- `NotificationItem` - Individual notification card\n\n### Triggers\n\nNotifications should be triggered:\n1. When vendor submits request → notify admins\n2. When admin approves → notify vendor\n3. When admin rejects → notify vendor\n4. When vendor cancels → notify admins (optional)\n\n## Acceptance Criteria\n- [ ] Database schema for notifications created\n- [ ] Email templates created for all notification types\n- [ ] NotificationService implemented\n- [ ] Notification API endpoints created\n- [ ] Notifications triggered on tier request events\n- [ ] Email sending integrated (Resend, SendGrid, or similar)\n- [ ] In-app notification UI components created\n- [ ] Notification bell icon shows unread count\n- [ ] Notifications can be marked as read\n- [ ] Email preferences (allow opt-out)\n- [ ] Proper error handling for failed emails\n- [ ] Rate limiting on notification sending","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-11-04T14:05:46.094788558+01:00","updated_at":"2025-12-06T18:18:12.606521671+01:00","closed_at":"2025-12-06T18:18:12.606521671+01:00","labels":["backend","enhancement","notifications"],"dependencies":[{"issue_id":"ptnextjs-bc46","depends_on_id":"ptnextjs-bbec","type":"blocks","created_at":"2025-11-04T14:05:46.107769024+01:00","created_by":"edwin"}]}
{"id":"ptnextjs-bd2d","title":"Fix Test 6.9: Reduce description length to respect 500 char limit","description":"Test 6.9 fills 562-char description but form validates max 500 chars. Need to change test to use 450-char description. File: tests/e2e/vendor-onboarding/06-tier1-advanced-profile.spec.ts line ~460","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-03T13:57:16.829136433+01:00","updated_at":"2025-11-03T18:59:05.592952085+01:00","closed_at":"2025-11-03T18:59:05.592952085+01:00","labels":["testing","validation"]}
{"id":"ptnextjs-bd61","title":"E2E Test Suite 11: Security \u0026 Access Control","description":"Implement 6 test scenarios for security (auth, XSS, CSRF, rate limiting). File: tests/e2e/vendor-onboarding/11-security-access-control.spec.ts","acceptance_criteria":"✓ Test 11.1: Vendor cannot access another vendor's dashboard (403)\n✓ Test 11.2: API rejects tier-restricted fields from lower tier vendors\n✓ Test 11.3: API prevents vendor from updating another vendor\n✓ Test 11.4: XSS prevention - script injection sanitized\n✓ Test 11.5: CSRF protection enforced on mutations\n✓ Test 11.6: Rate limiting prevents abuse (429 after threshold)\n✓ Verifies authorization checks\n✓ Tests XSS/CSRF protection mechanisms\n✓ Security vulnerabilities addressed\n✓ All 6 security tests passing\n✓ Execution time \u003c 6 minutes","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-03T09:15:27.284166815+01:00","updated_at":"2025-11-03T10:49:46.943775907+01:00","closed_at":"2025-11-03T10:49:46.943775907+01:00","labels":["e2e","security","testing"]}
{"id":"ptnextjs-bd78","title":"BE-4: Create ExcelParserService - NEXT TASK","description":"Parse uploaded Excel files into structured data. Parse 3 sheets (Company Info, Products, Locations), convert cell values to proper types, resolve relationships (category names to IDs), sanitize formula injection. Critical path task for import functionality.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-06T22:00:18.249209392+01:00","updated_at":"2025-11-06T22:08:22.17383224+01:00","closed_at":"2025-11-06T22:08:22.17383224+01:00","labels":["backend","excel-import-export","next-session","services"]}
{"id":"ptnextjs-bd89","title":"impl-backend-collection: Implement TierUpgradeRequests Payload Collection","description":"Priority: 1","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-04T15:44:30.852698739+01:00","updated_at":"2025-11-04T19:53:44.846547599+01:00","closed_at":"2025-11-04T19:53:44.846547599+01:00"}
{"id":"ptnextjs-bhi","title":"Testing: Unit tests for tier change service","description":"Write unit tests for TierChangeRequestService covering: validation (downgrade vs upgrade logic), unique pending request constraint, tier comparison helpers, approval/rejection flows, cancellation. Follow existing test patterns from tier-upgrade-request-service.test.ts.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-05T14:41:30.329668978+01:00","updated_at":"2025-12-05T14:42:27.074678053+01:00","closed_at":"2025-12-05T14:42:27.074678053+01:00","dependencies":[{"issue_id":"ptnextjs-bhi","depends_on_id":"ptnextjs-ju9","type":"blocks","created_at":"2025-12-05T14:41:56.041511276+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-bhi","depends_on_id":"ptnextjs-0dh","type":"blocks","created_at":"2025-12-05T14:41:56.298795179+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-bys","title":"[Downgrade] Testing: Unit tests for tier change service","description":"Write unit tests:\n- Downgrade validation (only lower tiers allowed)\n- Upgrade validation (only higher tiers allowed)\n- Pending request constraint (one at a time)\n- Approval/rejection flows for both types\n- Direct tier change by admin\nFollow patterns from tier-upgrade-request-service.test.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-05T14:43:22.750788067+01:00","updated_at":"2025-12-05T15:24:29.156557375+01:00","closed_at":"2025-12-05T15:24:29.156557375+01:00","dependencies":[{"issue_id":"ptnextjs-bys","depends_on_id":"ptnextjs-897c","type":"blocks","created_at":"2025-12-05T14:43:32.041606608+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-bys","depends_on_id":"ptnextjs-xgf","type":"blocks","created_at":"2025-12-05T14:43:42.837895243+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-c05","title":"[Downgrade] Backend: Add vendor portal API endpoints","description":"Add endpoints for vendor-initiated downgrade requests:\n- POST /api/portal/vendors/[id]/tier-downgrade-request\n- GET /api/portal/vendors/[id]/tier-request (unified - returns pending upgrade OR downgrade)\n- DELETE /api/portal/vendors/[id]/tier-request/[id] (cancel either type)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-05T14:42:45.323188563+01:00","updated_at":"2025-12-05T15:31:37.600346571+01:00","closed_at":"2025-12-05T15:31:37.600346571+01:00","dependencies":[{"issue_id":"ptnextjs-c05","depends_on_id":"ptnextjs-897c","type":"blocks","created_at":"2025-12-05T14:43:31.820982309+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-c05","depends_on_id":"ptnextjs-xgf","type":"blocks","created_at":"2025-12-05T14:43:42.708429009+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-c0c","title":"Add new email functions to EmailService","description":"Add to EmailService.ts: sendUserApprovedEmail(), sendUserRejectedEmail(), sendProfileSubmittedAdminEmail(), sendProfileSubmittedVendorEmail(), rename existing functions for clarity.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-03T17:17:53.272282959+01:00","updated_at":"2025-12-03T18:53:34.06503078+01:00","closed_at":"2025-12-03T18:53:34.06503078+01:00","dependencies":[{"issue_id":"ptnextjs-c0c","depends_on_id":"ptnextjs-tnj","type":"blocks","created_at":"2025-12-03T17:18:14.556164847+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-c141","title":"test-backend-admin-api: Design Admin API Endpoint Tests","description":"Priority: 1","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-04T15:44:30.860775815+01:00","updated_at":"2025-11-04T19:54:03.824308174+01:00","closed_at":"2025-11-04T19:54:03.824308174+01:00"}
{"id":"ptnextjs-c369","title":"Fix test framework mismatches","description":"file-upload-integration.test.tsx: Convert from Vitest to Jest. full-stack-locations.test.ts: Move Playwright E2E test to tests/e2e/ directory.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-07T22:27:40.296621079+01:00","updated_at":"2025-11-08T07:21:53.352390458+01:00","closed_at":"2025-11-08T07:21:53.352390458+01:00","labels":["cleanup","configuration","testing"]}
{"id":"ptnextjs-c3af","title":"[E2E Quarantine] Fix tab rendering for Certifications/Team tests (15 tests)","description":"Root Cause: Tests cannot find Certifications and Team tabs after navigating to profile page. Tabs may render differently in test environment, be tier-gated, or have changed selectors.\n\nAffected Tests:\n- certifications-awards-manager.spec.ts (5 tests)\n- team-members-manager.spec.ts (10 tests)\n\nInvestigation Steps:\n1. Verify tier1 test vendor has access to Certifications tab\n2. Check ProfileEditTabs.tsx for conditional tab rendering based on tier\n3. Add debug test to log all visible tabs after login\n4. Check if tab selectors have changed\n\nFix Options:\nA) Update test vendor tier if tabs are tier-restricted\nB) Update selectors if tab structure changed\nC) Add data-testid attributes to tabs for reliability\n\nImpact: ~15 tests can be unquarantined\n\nPriority: P2 (Requires component investigation)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-11T13:34:46.860946888+01:00","updated_at":"2025-12-11T13:58:16.07965333+01:00","closed_at":"2025-12-11T13:58:16.07965333+01:00"}
{"id":"ptnextjs-c810","title":"Fix remaining 5 tier-upgrade unit test failures","description":"Fix tier-specific unit test failures identified in validation report. Tests: TierUpgradeRequests.test.ts tier validation, UpgradeRequestStatusCard.test.tsx reviewer display, async timing issues. Files: __tests__/payload/collections/TierUpgradeRequests.test.ts, components/dashboard/__tests__/*.test.tsx","acceptance_criteria":"All tier-upgrade specific tests pass, no async timing issues, test coverage 85%+","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-06T09:47:50.761999003+01:00","updated_at":"2025-11-06T10:11:06.179319438+01:00","closed_at":"2025-11-06T10:11:06.179323109+01:00","labels":["pre-merge","testing","tier-upgrade-system"]}
{"id":"ptnextjs-ca78","title":"impl-backend-vendor-api: Implement Vendor Portal API Endpoints","description":"Priority: 1","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-04T15:44:30.859517222+01:00","updated_at":"2025-11-04T19:53:44.853740431+01:00","closed_at":"2025-11-04T19:53:44.853740431+01:00"}
{"id":"ptnextjs-cad0","title":"Fix component rendering tests (7 test files, ~24 failing tests)","description":"ProfileEditTabs: 8 failures - tab count mismatches, lock icon rendering. OwnerReviews: 8 failures - Dialog ARIA, mock callbacks. PerformanceMetrics: 6 failures - duplicate testids. VisualDemo: 6 failures - missing testids, click handlers. TierGate/GeocodingButton: Missing hooks/services.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-07T22:27:37.855378893+01:00","updated_at":"2025-11-08T07:21:57.91672924+01:00","closed_at":"2025-11-08T07:21:57.91672924+01:00","labels":["components","testing","ui"]}
{"id":"ptnextjs-cal","title":"[BE-6] Verify backend API endpoints with manual testing","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-10T07:45:06.212927175+01:00","updated_at":"2025-12-10T08:12:09.456340236+01:00","closed_at":"2025-12-10T08:12:09.456340236+01:00","dependencies":[{"issue_id":"ptnextjs-cal","depends_on_id":"ptnextjs-7hs","type":"blocks","created_at":"2025-12-10T07:45:57.726569869+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-cal","depends_on_id":"ptnextjs-0mg","type":"blocks","created_at":"2025-12-10T07:45:57.738859699+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-cal","depends_on_id":"ptnextjs-9xq","type":"blocks","created_at":"2025-12-10T07:45:57.749919653+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-cizu","title":"Investigate auth/navigation timeouts in E2E tests (25+ failures)","description":"Multiple test files failing with navigation timeouts to /vendor/dashboard and form fill timeouts on John Smith placeholder. Affected files: vendor-dashboard-enhanced (11), security-access-control (5), tier-restriction-flow (4), vendor-dashboard-flow (3). Root cause investigation needed - likely auth flow failing or extremely slow. HIGH PRIORITY - 25+ tests impacted.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-10T15:41:16.218706308+01:00","updated_at":"2025-12-10T16:42:49.15797915+01:00","closed_at":"2025-12-10T16:42:49.15797915+01:00"}
{"id":"ptnextjs-cjr","title":"Backend: Wire email notifications for tier changes","description":"Add afterChange hooks to TierChangeRequest collection to send appropriate emails. Handle: request submitted (admin email), request approved (vendor email), request rejected (vendor email). Also send email when admin directly changes tier.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-05T14:41:16.193432257+01:00","updated_at":"2025-12-05T14:42:27.039167198+01:00","closed_at":"2025-12-05T14:42:27.039167198+01:00","dependencies":[{"issue_id":"ptnextjs-cjr","depends_on_id":"ptnextjs-49d","type":"blocks","created_at":"2025-12-05T14:41:56.027158591+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-cjr","depends_on_id":"ptnextjs-0dh","type":"blocks","created_at":"2025-12-05T14:41:56.267659603+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-cky","title":"Rename loginUrl to contactUrl in sendUserRejectedEmail","description":"In lib/services/EmailService.ts:721, the variable loginUrl is misleading - it actually points to /contact page for rejected users, not a login page. Rename to contactUrl for clarity.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-03T19:12:08.799612597+01:00","updated_at":"2025-12-03T19:21:11.447883268+01:00","closed_at":"2025-12-03T19:21:11.447883268+01:00"}
{"id":"ptnextjs-clm","title":"Fix vendor dashboard page styling and UX issues","description":"## Problem\nThe vendor dashboard page has several styling and UX issues that need to be addressed:\n\n1. **Right nav column is too long** - The right navigation column extends much longer than the rest of the page body, creating visual imbalance\n2. **General styling inconsistencies** - Various styling issues need to be identified and fixed\n\n## Requirements\n\n### UX Analysis \u0026 Improvements\n- Analyze the current vendor dashboard layout and UX\n- Identify all usability issues and areas for improvement\n- Propose and implement improvements to make the page more usable and clear\n- **Do NOT remove any functionality or introduce bugs**\n\n### Styling Fixes\n- Fix the right nav column height/length issue\n- Ensure all components adhere to project theming standards\n- Use centralized styling (Tailwind CSS, shadcn/ui patterns)\n- Verify dark mode styling is correct for all components\n- Test both light and dark mode thoroughly\n\n### Testing\n- Visually verify all changes in both light and dark mode\n- Use Playwright to verify the page renders correctly\n- Ensure no functionality is broken after styling changes\n\n## Files to Review\n- `app/(dashboard)/vendor/dashboard/page.tsx`\n- Related dashboard components in `components/dashboard/`\n- Any layout files affecting the vendor dashboard\n\n## Acceptance Criteria\n- [ ] Right nav column matches page body height appropriately\n- [ ] All styling follows project theming standards\n- [ ] Dark mode works correctly\n- [ ] No functionality removed or broken\n- [ ] Page is more usable and visually clear","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-22T10:42:46.806053687+01:00","updated_at":"2025-11-22T10:55:05.427471972+01:00","closed_at":"2025-11-22T10:55:05.427471972+01:00","labels":["dark-mode","dashboard","styling","ux"]}
{"id":"ptnextjs-cpp","title":"Task 1: Setup Resend Integration \u0026 Environment Configuration","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-03T11:59:15.145875207+01:00","updated_at":"2025-12-03T12:01:52.679575787+01:00","closed_at":"2025-12-03T12:01:52.679575787+01:00"}
{"id":"ptnextjs-ct1","title":"Add profileSubmitted field to Vendors collection","description":"Add boolean field 'profileSubmitted' (default: false) to Vendors collection schema. This tracks whether vendor has submitted their profile for initial review.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-03T17:16:46.604309356+01:00","updated_at":"2025-12-03T17:33:45.740209874+01:00","closed_at":"2025-12-03T17:33:45.740209874+01:00"}
{"id":"ptnextjs-cw6","title":"[Downgrade] Backend: Add admin API endpoints","description":"Add admin endpoints:\n- GET /api/admin/tier-requests (list all, filter by type)\n- PUT /api/admin/tier-requests/[id]/approve (works for both types)\n- PUT /api/admin/tier-requests/[id]/reject (works for both types)\n- PUT /api/admin/vendors/[id]/tier (direct tier change by admin)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-05T14:42:45.336678254+01:00","updated_at":"2025-12-05T15:31:37.616326359+01:00","closed_at":"2025-12-05T15:31:37.616326359+01:00","dependencies":[{"issue_id":"ptnextjs-cw6","depends_on_id":"ptnextjs-897c","type":"blocks","created_at":"2025-12-05T14:43:31.841366292+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-cw6","depends_on_id":"ptnextjs-xgf","type":"blocks","created_at":"2025-12-05T14:43:42.724311647+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-d68d","title":"valid-security: Security Validation","description":"Priority: 0","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-04T15:44:30.878841582+01:00","updated_at":"2025-11-06T08:57:32.736789747+01:00","closed_at":"2025-11-06T08:57:32.736789747+01:00"}
{"id":"ptnextjs-d6z","title":"Add tests for new email functions (Wave 2-4)","description":"EmailService.test.ts is missing tests for the 4 new email functions added in Wave 2-4: sendUserApprovedEmail, sendUserRejectedEmail, sendProfileSubmittedAdminEmail, sendProfileSubmittedVendorEmail. Add test cases verifying function signatures, type definitions, and UserEmailData/ProfileSubmissionEmailData interfaces.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-03T19:12:06.021560885+01:00","updated_at":"2025-12-03T19:27:48.707078142+01:00","closed_at":"2025-12-03T19:27:48.707078142+01:00"}
{"id":"ptnextjs-d777","title":"E2E Test Suite 08: Tier 3 Promotions","description":"Implement 5 test scenarios for tier 3 promotion features. File: tests/e2e/vendor-onboarding/08-tier3-promotions.spec.ts","acceptance_criteria":"✓ Test 8.1: Access promotion pack tab (tier 3 only)\n✓ Test 8.2: Featured placement toggle functionality\n✓ Test 8.3: Editorial content display (read-only)\n✓ Test 8.4: Tier 3 enterprise badge display on profile\n✓ Test 8.5: Unlimited locations allowed (\u003e10)\n✓ Verifies tier 3 exclusive features\n✓ Tests featured vendor functionality\n✓ Contact sales CTA visible\n✓ All 5 tests passing\n✓ Execution time \u003c 4 minutes","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-03T09:15:23.339422647+01:00","updated_at":"2025-11-03T12:29:37.457048427+01:00","closed_at":"2025-11-03T12:29:37.457048427+01:00","labels":["advanced-features","e2e","testing"]}
{"id":"ptnextjs-d8c8","title":"Configure CI/CD Pipeline for E2E Tests","description":"Set up GitHub Actions workflow for automated E2E test execution on PRs. File: .github/workflows/e2e-vendor-onboarding.yml","status":"closed","priority":3,"issue_type":"task","created_at":"2025-11-03T09:15:29.805496722+01:00","updated_at":"2025-12-06T18:12:29.227964315+01:00","closed_at":"2025-12-06T18:12:29.227964315+01:00","labels":["automation","ci-cd","testing"]}
{"id":"ptnextjs-db7e","title":"Implement Admin Authentication for E2E Tests","description":"Admin API endpoints (approve, reject, tier upgrade) return 401 unauthorized when called from tests. Tests 2.2 and 2.5 in Suite 02 currently expect this behavior. Need to either: 1) Implement admin login flow in tests, 2) Add test mode bypass for admin APIs, or 3) Update tests to gracefully handle 401 responses. Current workaround: tests check for [200, 401, 403] status codes.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-03T10:56:27.122690328+01:00","updated_at":"2025-11-03T19:07:36.594465046+01:00","closed_at":"2025-11-03T19:07:36.594465046+01:00","labels":["admin","auth","e2e"]}
{"id":"ptnextjs-e0a1","title":"final-validation: Final Quality Validation","description":"Priority: 0","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-04T15:44:30.884546754+01:00","updated_at":"2025-11-06T08:57:37.199658055+01:00","closed_at":"2025-11-06T08:57:37.199658055+01:00"}
{"id":"ptnextjs-e0b6","title":"impl-frontend-comparison: Implement TierComparisonTable Component","description":"Priority: 1","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-04T15:44:30.864897809+01:00","updated_at":"2025-11-04T21:07:15.976686876+01:00","closed_at":"2025-11-04T21:07:15.976686876+01:00"}
{"id":"ptnextjs-e30","title":"[Downgrade] Frontend: Update admin tier request queue","description":"Update AdminTierRequestQueue component:\n- Add type filter (all/upgrade/downgrade)\n- Visual distinction (badges, colors, icons)\n- Same approve/reject flow for both types\n- Show request type in the list","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-05T14:42:57.910163837+01:00","updated_at":"2025-12-05T15:41:08.514307705+01:00","closed_at":"2025-12-05T15:41:08.514307705+01:00","dependencies":[{"issue_id":"ptnextjs-e30","depends_on_id":"ptnextjs-897c","type":"blocks","created_at":"2025-12-05T14:43:31.917497461+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-e30","depends_on_id":"ptnextjs-cw6","type":"blocks","created_at":"2025-12-05T14:43:42.786318965+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-e6k","title":"Add tests for validateTierRequest with downgrade scenarios","description":"Current tests only cover validateTierUpgradeRequest (legacy function). Add tests specifically for validateTierRequest with 'downgrade' requestType parameter to improve test coverage.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-05T16:08:38.415001929+01:00","updated_at":"2025-12-05T16:17:13.605795322+01:00","closed_at":"2025-12-05T16:17:13.605795322+01:00"}
{"id":"ptnextjs-e8de","title":"E2E Test Suite 06: Tier 1 Advanced Profile","description":"Implement 9 test scenarios for tier 1 features (certifications, awards, team, case studies). File: tests/e2e/vendor-onboarding/06-tier1-advanced-profile.spec.ts","acceptance_criteria":"✓ Test 6.1: Fill brand story (website, social links, founded year)\n✓ Test 6.2: Add certification (ISO 9001)\n✓ Test 6.3: Edit existing certification\n✓ Test 6.4: Delete certification with confirmation\n✓ Test 6.5: Add award with details\n✓ Test 6.6: Add case study with full details\n✓ Test 6.7: Add team member with photo\n✓ Test 6.8: Reorder team members via drag-and-drop\n✓ Test 6.9: Add long company description (rich text)\n✓ Tests all tier 1 features\n✓ Verifies years in business computation\n✓ CRUD operations working for all entities\n✓ All 9 tests passing\n✓ Execution time \u003c 6 minutes","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-03T09:15:20.859813226+01:00","updated_at":"2025-11-03T12:27:20.485983611+01:00","closed_at":"2025-11-03T12:27:20.485983611+01:00","labels":["advanced-features","e2e","testing"]}
{"id":"ptnextjs-e9u","title":"Frontend: Create TierDowngradeRequestForm component","description":"Create TierDowngradeRequestForm component similar to TierUpgradeRequestForm. Include: tier selection (only lower tiers), warning about feature loss, optional notes field, confirmation dialog explaining what will be hidden on profile. Use same validation patterns as upgrade form.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-05T14:40:48.509273846+01:00","updated_at":"2025-12-05T14:42:26.94377229+01:00","closed_at":"2025-12-05T14:42:26.94377229+01:00","dependencies":[{"issue_id":"ptnextjs-e9u","depends_on_id":"ptnextjs-070","type":"blocks","created_at":"2025-12-05T14:41:55.955880237+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-e9u","depends_on_id":"ptnextjs-0dh","type":"blocks","created_at":"2025-12-05T14:41:56.180083887+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-eea7","title":"health-3: Create /api/health/ready Database Check","description":"Create readiness endpoint with database connectivity check","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-06T17:08:00.001722445+01:00","updated_at":"2025-11-06T17:10:11.354433095+01:00","closed_at":"2025-11-06T17:10:11.354433095+01:00","labels":["docker","health-check"]}
{"id":"ptnextjs-f10d","title":"E2E Test Suite 10: Public Profile Display","description":"Implement 6 test scenarios for tier-specific public profile display. File: tests/e2e/vendor-onboarding/10-public-profile-display.spec.ts","acceptance_criteria":"✓ Test 10.1: Free tier public profile shows basic info only\n✓ Test 10.2: Tier 1 public profile shows enhanced features\n✓ Test 10.3: Tier 2 public profile shows locations map\n✓ Test 10.4: Tier 3 public profile shows featured badge\n✓ Test 10.5: Responsive design works on mobile (375px viewport)\n✓ Test 10.6: SEO metadata present (title, description, OG tags)\n✓ Verifies tier-specific visibility\n✓ Tests responsive layout (mobile, tablet, desktop)\n✓ Validates computed fields (years in business)\n✓ All 6 tests passing\n✓ Execution time \u003c 4 minutes","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-03T09:15:25.972140863+01:00","updated_at":"2025-11-03T12:35:20.65642041+01:00","closed_at":"2025-11-03T12:35:20.65642041+01:00","labels":["e2e","public-facing","testing"]}
{"id":"ptnextjs-f18f","title":"test-frontend-components: Design Frontend Component Tests","description":"Priority: 1","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-04T15:44:30.863563133+01:00","updated_at":"2025-11-04T20:52:03.528889221+01:00","closed_at":"2025-11-04T20:52:03.528889221+01:00"}
{"id":"ptnextjs-f248","title":"Implement Test Vendor Seed API Endpoint","description":"Create POST /api/test/vendors/seed endpoint for bulk vendor creation. Speeds up E2E tests by 10x. NODE_ENV guard required.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-03T09:14:49.648685746+01:00","updated_at":"2025-11-03T09:43:54.364112728+01:00","closed_at":"2025-11-03T09:43:54.364112728+01:00","labels":["api","backend","performance","testing"]}
{"id":"ptnextjs-f617","title":"Fix vendor seed API locations handling","description":"The seed API at app/api/test/vendors/seed/route.ts (lines 141-153) is incorrectly trying to create locations in a non-existent 'vendor-locations' collection. Locations are stored as an array field in the Vendors collection. Fix: Include locations array directly in vendor creation data instead of creating separate documents.","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-11-03T15:21:04.772034231+01:00","updated_at":"2025-11-03T15:22:16.386137426+01:00","closed_at":"2025-11-03T15:22:16.386137426+01:00","labels":["api","backend","database","seed"]}
{"id":"ptnextjs-f7ab","title":"impl-backend-service: Implement TierUpgradeRequestService","description":"Priority: 1","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-04T15:44:30.85688602+01:00","updated_at":"2025-11-04T19:53:44.85042997+01:00","closed_at":"2025-11-04T19:53:44.85042997+01:00"}
{"id":"ptnextjs-f9d4","title":"Implement Test Product Seed API Endpoint","description":"Create POST /api/test/products/seed endpoint for bulk product creation. Required for product management tests.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-03T09:14:51.091805062+01:00","updated_at":"2025-11-03T09:43:54.366923149+01:00","closed_at":"2025-11-03T09:43:54.366923149+01:00","labels":["api","backend","testing"]}
{"id":"ptnextjs-fdf2","title":"E2E Test Suite 12: End-to-End Happy Path","description":"Implement complete vendor journey test from registration to tier 3. File: tests/e2e/vendor-onboarding/12-e2e-happy-path.spec.ts","acceptance_criteria":"✓ Step 1: Complete registration flow\n✓ Step 2: Admin approval process\n✓ Step 3: First login to dashboard\n✓ Step 4: Free tier profile setup\n✓ Step 5: Upgrade to tier 1\n✓ Step 6: Fill tier 1 brand story and add certifications\n✓ Step 7: Add team members and case studies\n✓ Step 8: Upgrade to tier 2\n✓ Step 9: Add multiple locations with map\n✓ Step 10: Add products\n✓ Step 11: Upgrade to tier 3\n✓ Step 12: Enable featured placement\n✓ Step 13: Verify complete public profile display\n✓ Single comprehensive test covering full journey\n✓ All features used in sequence\n✓ Data persistence verified across workflow\n✓ Execution time \u003c 8 minutes","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-03T09:15:28.522263684+01:00","updated_at":"2025-11-03T12:37:32.93098421+01:00","closed_at":"2025-11-03T12:37:32.93098421+01:00","labels":["e2e","integration","testing"]}
{"id":"ptnextjs-fec","title":"Task 2: Create Email Service Layer","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-03T11:59:18.050164263+01:00","updated_at":"2025-12-03T12:07:55.002777389+01:00","closed_at":"2025-12-03T12:07:55.002777389+01:00","dependencies":[{"issue_id":"ptnextjs-fec","depends_on_id":"ptnextjs-cpp","type":"blocks","created_at":"2025-12-03T11:59:36.895226458+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-fedb","title":"impl-frontend-page: Implement Subscription Page Route","description":"Priority: 1","notes":"Subscription page implemented with features: current tier display, tier comparison table, upgrade request form/status, authentication guards, loading states, error handling. 241 lines.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-04T15:44:30.869446147+01:00","updated_at":"2025-11-05T07:29:44.412542051+01:00","closed_at":"2025-11-05T07:29:44.412542051+01:00"}
{"id":"ptnextjs-fel","title":"Add rate limiting to GET endpoint in tier-downgrade-request","description":"GET /api/portal/vendors/[id]/tier-downgrade-request is not rate-limited. Add rate limiting with higher threshold (e.g., 60 requests/minute) to prevent potential abuse.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-05T16:08:25.796888472+01:00","updated_at":"2025-12-05T16:14:55.170250349+01:00","closed_at":"2025-12-05T16:14:55.170250349+01:00"}
{"id":"ptnextjs-ffb6","title":"impl-frontend-nav: Update Navigation and Upgrade Prompts","description":"Priority: 1","notes":"Navigation updates complete: 1) Added Subscription link to VendorNavigation with CreditCard icon, 2) Updated UpgradePromptCard button from 'Contact Sales' to 'View Subscription Options' linking to /vendor/dashboard/subscription, 3) Updated DashboardSidebar button to link to subscription page","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-04T15:44:30.870904913+01:00","updated_at":"2025-11-05T07:36:35.67690871+01:00","closed_at":"2025-11-05T07:36:35.67690871+01:00"}
{"id":"ptnextjs-h2b","title":"Task 4: Add Payload CMS Hooks for Vendor Registration","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-03T11:59:22.423033844+01:00","updated_at":"2025-12-03T12:18:37.12064318+01:00","closed_at":"2025-12-03T12:18:37.12064318+01:00","dependencies":[{"issue_id":"ptnextjs-h2b","depends_on_id":"ptnextjs-fec","type":"blocks","created_at":"2025-12-03T11:59:36.964663735+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-h2b","depends_on_id":"ptnextjs-5f5","type":"blocks","created_at":"2025-12-03T11:59:36.996498552+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-ha7","title":"[Downgrade] CRITICAL: Audit profile rendering for tier-based hiding","description":"CRITICAL: Ensure public vendor profile hides tier-restricted content based on current tier WITHOUT deleting CMS data.\n\nComponents to audit:\n- VendorHero (tier badges, featured status)\n- VendorAboutSection (longDescription - tier1+)\n- VendorCertificationsSection (tier1+)\n- VendorCaseStudiesSection (tier1+)\n- VendorTeamSection (tier1+)\n- VendorMediaGallery (tier1+)\n- VendorProductsSection (tier2+ - Products tab)\n- LocationsDisplaySection (multi-location tier2+)\n\nVerify: When tier goes from tier2 to tier1, locations beyond first are hidden but NOT deleted. Data remains in CMS for potential re-upgrade.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-05T14:43:12.308563944+01:00","updated_at":"2025-12-05T15:10:01.274820674+01:00","closed_at":"2025-12-05T15:10:01.274820674+01:00","dependencies":[{"issue_id":"ptnextjs-ha7","depends_on_id":"ptnextjs-897c","type":"blocks","created_at":"2025-12-05T14:43:31.963148223+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-him","title":"[FE-7] Add TypeScript types for Product API responses","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-10T07:45:25.140426489+01:00","updated_at":"2025-12-10T08:12:45.481887793+01:00","closed_at":"2025-12-10T08:12:45.481887793+01:00","dependencies":[{"issue_id":"ptnextjs-him","depends_on_id":"ptnextjs-7hs","type":"blocks","created_at":"2025-12-10T07:46:06.866815582+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-i9x","title":"[Downgrade] Backend: Extend tier request schema for downgrades","description":"Extend TierUpgradeRequest or create TierChangeRequest to support downgrades:\n- Add requestType field: 'upgrade' | 'downgrade'\n- Update validation to allow lower tiers for downgrade type\n- Keep single pending request constraint (either upgrade or downgrade)\n- No data archival - just tier change. CMS data stays, profile rendering hides it.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-05T14:42:45.296416012+01:00","updated_at":"2025-12-05T15:08:44.095413761+01:00","closed_at":"2025-12-05T15:08:44.095413761+01:00","dependencies":[{"issue_id":"ptnextjs-i9x","depends_on_id":"ptnextjs-897c","type":"blocks","created_at":"2025-12-05T14:43:31.780821941+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-ihi","title":"Remove unused token variable in tier-downgrade API routes","description":"Token variable is retrieved but never used in tier-downgrade-request/route.ts:25 and [requestId]/route.ts:25. Either remove or add explicit check before calling payload.auth().","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-05T16:08:32.735148188+01:00","updated_at":"2025-12-05T16:14:55.191149977+01:00","closed_at":"2025-12-05T16:14:55.191149977+01:00"}
{"id":"ptnextjs-j45t","title":"[E2E Quarantine] Update product management tests for current page structure (7 tests)","description":"Root Cause: Tests written against old products page structure. Page navigation or layout has changed since tests were written.\n\nAffected Tests:\n- vendor-onboarding/09-product-management.spec.ts (7 tests)\n\nError Detail:\nTests cannot find 'Product' text after login, suggesting Products page structure changed.\n\nFix Steps:\n1. Compare current products page component with test selectors\n2. Update navigation path if products page moved\n3. Update selectors to match current UI structure\n4. Add data-testid attributes for reliable selection\n\nImpact: ~7 tests can be unquarantined\n\nPriority: P3 (Requires UI investigation)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-11T13:34:56.245945445+01:00","updated_at":"2025-12-11T13:58:48.684586953+01:00","closed_at":"2025-12-11T13:58:48.684586953+01:00"}
{"id":"ptnextjs-ju9","title":"Backend: Create TierChangeRequest collection/service","description":"Create a unified TierChangeRequest collection (or extend TierUpgradeRequest) to handle both upgrades and downgrades. Add type field (upgrade/downgrade), update validation to allow lower tiers for downgrades, and create/update TierChangeRequestService with methods for both directions.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-05T14:40:24.770101971+01:00","updated_at":"2025-12-05T14:42:26.882504215+01:00","closed_at":"2025-12-05T14:42:26.882504215+01:00","dependencies":[{"issue_id":"ptnextjs-ju9","depends_on_id":"ptnextjs-0dh","type":"blocks","created_at":"2025-12-05T14:41:56.127912339+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-jue","title":"[INT-2] E2E test selector alignment","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-10T07:45:28.236388466+01:00","updated_at":"2025-12-10T08:21:05.520955928+01:00","closed_at":"2025-12-10T08:21:05.520955928+01:00","dependencies":[{"issue_id":"ptnextjs-jue","depends_on_id":"ptnextjs-r4v","type":"blocks","created_at":"2025-12-10T07:46:19.101181555+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-k19","title":"Frontend: Update AdminTierRequestQueue for downgrades","description":"Update AdminTierRequestQueue component to handle both upgrade and downgrade requests. Add type filter (all/upgrade/downgrade), visual distinction between request types (badges/icons), and appropriate messaging for approval/rejection of each type.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-05T14:41:00.148239765+01:00","updated_at":"2025-12-05T14:42:26.979149041+01:00","closed_at":"2025-12-05T14:42:26.979149041+01:00","dependencies":[{"issue_id":"ptnextjs-k19","depends_on_id":"ptnextjs-vqq","type":"blocks","created_at":"2025-12-05T14:41:56.001551373+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-k19","depends_on_id":"ptnextjs-0dh","type":"blocks","created_at":"2025-12-05T14:41:56.211244793+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-ko2","title":"[INT-3] Error handling and edge cases","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-10T07:45:39.588207058+01:00","updated_at":"2025-12-10T08:21:07.049978973+01:00","closed_at":"2025-12-10T08:21:07.049978973+01:00","dependencies":[{"issue_id":"ptnextjs-ko2","depends_on_id":"ptnextjs-r4v","type":"blocks","created_at":"2025-12-10T07:46:19.116325474+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-l8t","title":"Migrate existing vendors: backfill profileSubmitted field","description":"The profileSubmitted field was added to the Vendors schema as part of Wave 2-4 onboarding workflow. Existing vendors need migration consideration: 1) Vendors already published should have profileSubmitted=true (they were approved via old flow), 2) Unpublished vendors should remain profileSubmitted=false. Create a migration script to backfill this field based on vendor published status.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-03T19:14:03.70843015+01:00","updated_at":"2025-12-03T19:27:45.720786472+01:00","closed_at":"2025-12-03T19:27:45.720786472+01:00"}
{"id":"ptnextjs-mid","title":"Add database migration to change blog_posts.featured_image from TEXT to INTEGER foreign key","description":"Create migration script to convert featured_image column from TEXT (URL) to INTEGER (media ID foreign key). This will make image selection from media library foolproof for blog posts.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-11-24T19:56:35.384126786+01:00","updated_at":"2025-11-24T20:00:17.051627368+01:00","closed_at":"2025-11-24T20:00:17.051627368+01:00","labels":["database","migration"]}
{"id":"ptnextjs-mn13","title":"[E2E] Quarantine Repair Epic - Unquarantine 83 tests","description":"Master tracking issue for E2E quarantine repair work.\n\n## Summary\n83 tests are currently quarantined across 8 test files. This epic tracks all repair work.\n\n## Tasks by Priority\n\n### P1 - Quick Wins (High Impact, Low Effort)\n- ptnextjs-ohtg: Fix admin auth helper (13 tests)\n- ptnextjs-0vjj: Delete/update vendor-dashboard-flow.spec.ts (3 tests)\n\n### P2 - Medium Effort (High Test Count)\n- ptnextjs-ueru: Seed location test data (24 tests)\n- ptnextjs-p19a: Investigate Excel features (21 tests)\n- ptnextjs-c3af: Fix tab rendering (15 tests)\n\n### P3 - Requires Investigation\n- ptnextjs-j45t: Update product management tests (7 tests)\n\n## Test Count Summary\n| Category | Tests | Status |\n|----------|-------|--------|\n| Admin Auth | 13 | Open |\n| Location Data | 24 | Open |\n| Excel Features | 21 | Open |\n| Tab Rendering | 15 | Open |\n| Product Mgmt | 7 | Open |\n| Dashboard Flow | 3 | Open |\n| **Total** | **83** | - |\n\n## Success Criteria\n- All 83 quarantined tests either unquarantined or deleted with justification\n- E2E pass rate returns to \u003e95%\n- No tests remain in quarantine without tracking issue","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-11T13:35:18.607818436+01:00","updated_at":"2025-12-11T13:59:23.675392701+01:00","closed_at":"2025-12-11T13:59:23.675392701+01:00"}
{"id":"ptnextjs-o92","title":"Fix email template placeholder mismatch in tier-downgrade-approved","description":"EmailService.ts:747-756 sends REQUESTED_TIER but tier-downgrade-approved.html expects PREVIOUS_TIER and NEW_TIER placeholders. This causes blank values in approval emails.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-05T16:08:11.459630947+01:00","updated_at":"2025-12-05T16:09:35.939923559+01:00","closed_at":"2025-12-05T16:09:35.939923559+01:00"}
{"id":"ptnextjs-ohtg","title":"[E2E Quarantine] Fix admin auth helper for tier-downgrade tests (13 tests)","description":"Root Cause: Admin API calls return 401 Unauthorized. The loginAsAdmin() helper uses browser-based login but API calls fail.\n\nAffected Tests:\n- tier-downgrade-request-workflow.spec.ts (Suites 2, 3, 5 + test 4.3)\n\nFix Steps:\n1. Create API-based admin auth helper similar to loginVendor()\n2. Use Payload CMS admin API token for test admin operations\n3. Test admin flows through API with proper session handling\n\nImpact: ~13 tests can be unquarantined\n\nPriority: P1 (Quick win, high impact)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-11T13:34:16.071340962+01:00","updated_at":"2025-12-11T13:48:25.529325832+01:00","closed_at":"2025-12-11T13:48:25.529325832+01:00"}
{"id":"ptnextjs-p19a","title":"[E2E Quarantine] Investigate Excel Import/Export feature location (21 tests)","description":"Root Cause: Excel Import/Export features not visible on /vendor/dashboard/data-management page. Features may have been removed, relocated, or tier-restricted.\n\nAffected Tests:\n- excel-export.spec.ts (11 tests)\n- excel-import-happy-path.spec.ts (10 tests)\n\nInvestigation Steps:\n1. Check if data-management page still exists\n2. Verify if Excel Export/Import cards are present\n3. Check if features are tier-restricted (possibly tier3+ only)\n4. Look for ExcelExportCard and ExcelImportCard components\n\nDecision Required:\n- If features exist but relocated: Update test navigation\n- If features are tier-restricted: Update test to use correct tier\n- If features were removed: DELETE the tests (don't keep quarantined)\n\nImpact: ~21 tests - decision pending investigation\n\nPriority: P2 (Needs investigation before fix)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-11T13:34:36.917930041+01:00","updated_at":"2025-12-11T13:54:22.485643702+01:00","closed_at":"2025-12-11T13:54:22.485643702+01:00"}
{"id":"ptnextjs-p30","title":"[Downgrade] Backend: Create email templates","description":"Create email templates for tier downgrade:\n- tier-downgrade-requested.html (admin notification)\n- tier-downgrade-approved.html (vendor notification)\n- tier-downgrade-rejected.html (vendor notification)\n- tier-changed-by-admin.html (vendor notification for direct changes)\n\nFollow existing template patterns from tier-upgrade-*.html","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-05T14:43:12.335914954+01:00","updated_at":"2025-12-05T15:08:44.111892076+01:00","closed_at":"2025-12-05T15:08:44.111892076+01:00","dependencies":[{"issue_id":"ptnextjs-p30","depends_on_id":"ptnextjs-897c","type":"blocks","created_at":"2025-12-05T14:43:31.987308219+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-p7z","title":"[Downgrade] Testing: E2E tests for full workflow","description":"Playwright E2E tests:\n- Vendor submits downgrade request\n- Admin sees request in queue\n- Admin approves/rejects\n- Vendor profile updates (features hidden, data preserved)\n- Admin direct tier change\n- Verify hidden content is not deleted","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-05T14:43:22.780805986+01:00","updated_at":"2025-12-05T15:53:39.555284494+01:00","closed_at":"2025-12-05T15:53:39.555284494+01:00","dependencies":[{"issue_id":"ptnextjs-p7z","depends_on_id":"ptnextjs-897c","type":"blocks","created_at":"2025-12-05T14:43:32.072365788+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-p7z","depends_on_id":"ptnextjs-92b","type":"blocks","created_at":"2025-12-05T14:43:42.856358975+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-p7z","depends_on_id":"ptnextjs-e30","type":"blocks","created_at":"2025-12-05T14:43:42.87481769+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-p7z","depends_on_id":"ptnextjs-ha7","type":"blocks","created_at":"2025-12-05T14:43:42.89265603+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-p8q","title":"Add Vendor type to validateMandatoryFields in submit-profile API","description":"In app/api/portal/vendors/[id]/submit-profile/route.ts:35, the validateMandatoryFields function uses vendor: any which loses type safety. Import the Vendor type from Payload and use it for proper type checking.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-03T19:12:09.798347541+01:00","updated_at":"2025-12-03T19:21:12.718304517+01:00","closed_at":"2025-12-03T19:21:12.718304517+01:00"}
{"id":"ptnextjs-pbd","title":"Rename vendor-approved to profile-published email","description":"Rename vendor-approved.html to profile-published.html. Update email content to say profile is now live. Update Vendors hook to trigger on published=true (keep existing logic but clarify it's for publishing not approval).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-03T17:17:45.872603197+01:00","updated_at":"2025-12-03T17:33:45.793347854+01:00","closed_at":"2025-12-03T17:33:45.793347854+01:00"}
{"id":"ptnextjs-qj7","title":"[VAL-2] Final quality review and TypeScript check","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-10T07:45:41.423438748+01:00","updated_at":"2025-12-10T08:28:31.02068049+01:00","closed_at":"2025-12-10T08:28:31.02068049+01:00","dependencies":[{"issue_id":"ptnextjs-qj7","depends_on_id":"ptnextjs-rm9","type":"blocks","created_at":"2025-12-10T07:46:20.895938187+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-r4v","title":"[INT-1] Frontend-Backend data flow integration","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-10T07:45:25.942510513+01:00","updated_at":"2025-12-10T08:17:37.546193799+01:00","closed_at":"2025-12-10T08:17:37.546193799+01:00","dependencies":[{"issue_id":"ptnextjs-r4v","depends_on_id":"ptnextjs-03j","type":"blocks","created_at":"2025-12-10T07:46:19.072759926+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-r4v","depends_on_id":"ptnextjs-cal","type":"blocks","created_at":"2025-12-10T07:46:19.088320006+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-r5u","title":"Add profile submission API endpoint","description":"Create POST /api/portal/vendors/[id]/submit-profile endpoint. Sets profileSubmitted=true, sends emails to admin and vendor. Validates mandatory fields (description, logo, contactPhone) are filled.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-03T17:17:23.728477241+01:00","updated_at":"2025-12-03T18:57:53.586098386+01:00","closed_at":"2025-12-03T18:57:53.586098386+01:00","dependencies":[{"issue_id":"ptnextjs-r5u","depends_on_id":"ptnextjs-ct1","type":"blocks","created_at":"2025-12-03T17:18:14.614845622+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-r5u","depends_on_id":"ptnextjs-c0c","type":"blocks","created_at":"2025-12-03T17:18:14.630575859+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-rm9","title":"[VAL-1] Run and pass all E2E tests","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-10T07:45:40.570428672+01:00","updated_at":"2025-12-10T08:27:44.952696772+01:00","closed_at":"2025-12-10T08:27:44.952696772+01:00","dependencies":[{"issue_id":"ptnextjs-rm9","depends_on_id":"ptnextjs-jue","type":"blocks","created_at":"2025-12-10T07:46:20.872779236+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-rm9","depends_on_id":"ptnextjs-ko2","type":"blocks","created_at":"2025-12-10T07:46:20.884137728+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-sn6","title":"Documentation: Update CLAUDE.md with tier downgrade info","description":"Update CLAUDE.md to document the tier downgrade system: new API endpoints, new email templates, validation rules for downgrades, profile rendering behavior (hide vs delete). Also update the email notification table.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-05T14:41:42.118546544+01:00","updated_at":"2025-12-05T14:42:27.113975522+01:00","closed_at":"2025-12-05T14:42:27.113975522+01:00","dependencies":[{"issue_id":"ptnextjs-sn6","depends_on_id":"ptnextjs-cjr","type":"blocks","created_at":"2025-12-05T14:41:56.097025307+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-sn6","depends_on_id":"ptnextjs-uwj","type":"blocks","created_at":"2025-12-05T14:41:56.114465246+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-sn6","depends_on_id":"ptnextjs-0dh","type":"blocks","created_at":"2025-12-05T14:41:56.331138577+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-tnj","title":"Create profile submission email templates","description":"Create two templates: 1) profile-submitted-admin.html - notifies admin of new profile to review, 2) profile-submitted-vendor.html - thanks vendor, confirms profile is under review.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-03T17:17:30.543030432+01:00","updated_at":"2025-12-03T17:33:45.774491859+01:00","closed_at":"2025-12-03T17:33:45.774491859+01:00"}
{"id":"ptnextjs-tor","title":"Add Submit Profile button to vendor dashboard","description":"Add Submit for Review button to vendor dashboard. Button disabled until description, logo, contactPhone filled. Button hidden if profileSubmitted=true. Calls submit-profile API on click.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-03T17:17:38.149163715+01:00","updated_at":"2025-12-03T18:59:42.316931332+01:00","closed_at":"2025-12-03T18:59:42.316931332+01:00","dependencies":[{"issue_id":"ptnextjs-tor","depends_on_id":"ptnextjs-r5u","type":"blocks","created_at":"2025-12-03T17:18:14.645620298+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-ueru","title":"[E2E Quarantine] Seed location test data for vendor-location-mapping (24 tests)","description":"Root Cause: Tests depend on static vendor slugs (alfa-laval, caterpillar-marine, crestron) that don't exist in test database.\n\nAffected Tests:\n- vendor-location-mapping.spec.ts (24 tests)\n\nFix Options:\nA) Quick: Update global-setup.ts to seed vendors with these slugs and location data\nB) Better: Rewrite tests to use dynamically-created test vendors via seed-api-helpers\nC) Best: Create seedVendorWithLocations() helper in seed-api-helpers.ts\n\nImplementation Steps:\n1. Add vendor seeding with location coordinates to global-setup.ts\n2. Include slugs: alfa-laval, caterpillar-marine, crestron\n3. Add coordinates for map display testing\n4. Remove test.describe.skip wrapper\n\nImpact: ~24 tests can be unquarantined\n\nPriority: P2 (Medium effort, high test count)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-11T13:34:27.052341231+01:00","updated_at":"2025-12-11T13:57:16.234071495+01:00","closed_at":"2025-12-11T13:57:16.234071495+01:00"}
{"id":"ptnextjs-uwj","title":"Frontend: Ensure profile rendering respects tier (hide vs delete)","description":"CRITICAL: Audit and update all vendor profile display components to hide tier-restricted content based on current tier WITHOUT deleting CMS data. Components to check: VendorHero, VendorAboutSection, VendorCertificationsSection, VendorCaseStudiesSection, VendorTeamSection, VendorMediaGallery, VendorProductsSection, LocationsDisplaySection. Data stays in CMS, just not rendered on public profile.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-05T14:41:23.773776381+01:00","updated_at":"2025-12-05T14:42:27.058315981+01:00","closed_at":"2025-12-05T14:42:27.058315981+01:00","dependencies":[{"issue_id":"ptnextjs-uwj","depends_on_id":"ptnextjs-0dh","type":"blocks","created_at":"2025-12-05T14:41:56.285199961+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-vqq","title":"Backend: Add admin API endpoints for tier change management","description":"Create admin API endpoints: GET /api/admin/tier-change-requests (list all requests with type filter), PUT /api/admin/tier-change-requests/[id]/approve (approve and update vendor tier), PUT /api/admin/tier-change-requests/[id]/reject (reject with reason). Also add PUT /api/admin/vendors/[id]/tier (direct admin tier change without request).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-05T14:40:42.448075045+01:00","updated_at":"2025-12-05T14:42:26.919045454+01:00","closed_at":"2025-12-05T14:42:26.919045454+01:00","dependencies":[{"issue_id":"ptnextjs-vqq","depends_on_id":"ptnextjs-ju9","type":"blocks","created_at":"2025-12-05T14:41:55.939491242+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-vqq","depends_on_id":"ptnextjs-0dh","type":"blocks","created_at":"2025-12-05T14:41:56.162756272+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-wpx","title":"Add Media Gallery Tab to ProfileEditTabs","description":"Media Gallery - Phase 1 Complete ✅\n\nCOMPLETED (60%):\n- MediaGalleryItem interface with full typing\n- Vendor schema mediaGallery field (Tier 1+)\n- Pattern analysis (native drag-drop, Card layouts)\n- Progress documentation created\n\nNEXT (40%):\n- MediaGalleryManager component (2-3h)\n- ProfileEditTabs integration (1h)\n- Testing (3h)\n\nCOMMIT: 3c3ef9b\nBRANCH: vendor-media-gallery","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-11-08T10:22:47.92614767+01:00","updated_at":"2025-11-08T16:07:12.427214113+01:00","closed_at":"2025-11-08T16:07:12.427214113+01:00"}
{"id":"ptnextjs-xgf","title":"[Downgrade] Backend: Update TierUpgradeRequestService for downgrades","description":"Update service to handle both directions:\n- Add validateTierDowngradeRequest() or update existing validation\n- Update createDowngradeRequest() method\n- Approval just changes vendor.tier (data stays in CMS)\n- Add getTierChangeType() helper to determine if upgrade or downgrade","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-05T14:42:45.309348656+01:00","updated_at":"2025-12-05T15:24:29.140291094+01:00","closed_at":"2025-12-05T15:24:29.140291094+01:00","dependencies":[{"issue_id":"ptnextjs-xgf","depends_on_id":"ptnextjs-897c","type":"blocks","created_at":"2025-12-05T14:43:31.800454309+01:00","created_by":"daemon"},{"issue_id":"ptnextjs-xgf","depends_on_id":"ptnextjs-i9x","type":"blocks","created_at":"2025-12-05T14:43:42.693757284+01:00","created_by":"daemon"}]}
{"id":"ptnextjs-y7xq","title":"[E2E] Session conflict fix - auth tests now use unique vendors","description":"Fixed 3 of 4 failing E2E tests by enhancing vendor uniqueness:\n\nFIXED:\n- 03-authentication.spec.ts:82 (Session persistence) - now flaky/passes\n- 03-authentication.spec.ts:120 (Token refresh) - now passes\n- 04-free-tier-profile.spec.ts:141 (Upgrade prompts) - now passes\n\nNOT FIXED (different root cause):\n- vendor-dashboard.spec.ts:87 - application bug, see ptnextjs-1f7q\n\nChanges made:\n- Added random component to unique IDs in auth tests\n- Prevents collision during parallel test execution\n\nCommit: 3e5692f\n\nCore tier results improved from 131→136 passed, 4→1 failed","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-11T15:34:32.152848788+01:00","updated_at":"2025-12-11T15:34:37.221263094+01:00","closed_at":"2025-12-11T15:34:37.221263094+01:00"}
{"id":"ptnextjs-zpm","title":"Add hCaptcha to vendor registration form","description":"Add hCaptcha component to registration form following existing pattern from VendorReviews.tsx. Verify captcha token server-side before creating user/vendor.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-03T17:17:03.129909803+01:00","updated_at":"2025-12-03T18:55:50.406268457+01:00","closed_at":"2025-12-03T18:55:50.406268457+01:00","dependencies":[{"issue_id":"ptnextjs-zpm","depends_on_id":"ptnextjs-93g","type":"blocks","created_at":"2025-12-03T17:18:14.568884895+01:00","created_by":"daemon"}]}
