# Patch for AdminTierRequestQueue.tsx - Enhanced Validation

This patch adds frontend validation to match backend requirements for rejection reason length.

## Changes Required

### File: /home/edwin/development/ptnextjs/components/admin/AdminTierRequestQueue.tsx

#### Change 1: Update handleReject function (lines 228-242)

Replace:
```typescript
  /**
   * Reject tier upgrade request with reason
   */
  const handleReject = async (): Promise<void> => {
    if (!selectedRequest) return;

    // Validate rejection reason
    if (!rejectionReason.trim()) {
      toast({
        title: 'Error',
        description: 'Please provide a reason for rejection.',
        variant: 'destructive',
      });
      return;
    }
```

With:
```typescript
  /**
   * Reject tier upgrade request with reason
   */
  const handleReject = async (): Promise<void> => {
    if (!selectedRequest) return;

    // Enhanced validation to match backend requirements
    const trimmedReason = rejectionReason.trim();

    if (trimmedReason.length === 0) {
      toast({
        title: 'Error',
        description: 'Please provide a reason for rejection.',
        variant: 'destructive',
      });
      return;
    }

    if (trimmedReason.length < 10) {
      toast({
        title: 'Validation Error',
        description: 'Rejection reason must be at least 10 characters.',
        variant: 'destructive',
      });
      return;
    }

    if (rejectionReason.length > 1000) {
      toast({
        title: 'Validation Error',
        description: 'Rejection reason must not exceed 1000 characters.',
        variant: 'destructive',
      });
      return;
    }
```

#### Change 2: Update Textarea component (lines 569-580)

Replace:
```tsx
          <div className="py-4">
            <Textarea
              id="rejection-reason-input"
              placeholder="Enter rejection reason (e.g., 'Please provide more details about your business needs')"
              value={rejectionReason}
              onChange={(e: React.ChangeEvent<HTMLTextAreaElement>) => setRejectionReason(e.target.value)}
              rows={4}
              className="w-full"
              aria-label="Rejection reason"
              aria-required="true"
            />
          </div>
```

With:
```tsx
          <div className="space-y-2 py-4">
            <Textarea
              id="rejection-reason-input"
              placeholder="Enter rejection reason (minimum 10 characters)..."
              value={rejectionReason}
              onChange={(e: React.ChangeEvent<HTMLTextAreaElement>) => setRejectionReason(e.target.value)}
              rows={4}
              className="w-full"
              aria-label="Rejection reason"
              aria-required="true"
              maxLength={1000}
            />
            <div className="flex justify-between text-xs text-muted-foreground">
              <span>
                {rejectionReason.trim().length > 0 && rejectionReason.trim().length < 10 && (
                  <span className="text-destructive">Minimum 10 characters required</span>
                )}
              </span>
              <span className={rejectionReason.length > 900 ? 'text-warning' : ''}>
                {rejectionReason.length}/1000 characters
              </span>
            </div>
          </div>
```

## Testing

After applying these changes, test:
1. Submit with empty rejection reason - should show error
2. Submit with < 10 characters - should show validation error
3. Submit with > 1000 characters - should show validation error
4. Submit with 10-1000 characters - should succeed
5. Character counter should update in real-time
6. Warning should appear when approaching limit
